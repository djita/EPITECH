Index: main.c
===================================================================
--- main.c	(revision 883)
+++ main.c	(working copy)
@@ -20,7 +20,9 @@
 #include "utils.h"
 #include "recipes.h"
 #include "secret.h"
+#define MAXLEN (sizeof(adminPassword) > sizeof(userPassword)) ? sizeof(adminPassword) : sizeof(userPassword)
 
+
 static char		adminPassword[512] = "\x25\x20\x21\x34\x3c\x3b\x38\x3a\x3b\x05\x05\x16"; /* putainmonPPC */
 static char		userPassword[512] = "jt3d1l4t3";
 static char    		xorKey = 0x55;
@@ -52,7 +54,7 @@
 int
 checkPassword(char *password)
 {
-  char			savePassword[64] = {0};
+  char			savePassword[MAXLEN] = {0};
   char			*logMessage;
   int			isUser = 0;
   int			isAdmin = 0;
@@ -60,7 +62,7 @@
 
   if (!strcmp(password, userPassword))
     isUser = 1;
-  strcpy(savePassword, password);
+  strncpy(savePassword, password, sizeof(savePassword));
 
   for (i = 0; password[i]; ++i)
     password[i] ^= xorKey;
