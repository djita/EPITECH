<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>GHC/Integer/Type.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE BangPatterns, CPP, MagicHash, NoImplicitPrelude #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# OPTIONS_HADDOCK hide #-}</span>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-cpp'>#include "MachDeps.h"</span>
<a name="line-5"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == 4</span>
<a name="line-6"></a><span class='hs-cpp'>#define INT_MINBOUND (-2147483648#)</span>
<a name="line-7"></a><span class='hs-cpp'>#define NEG_INT_MINBOUND (S# 2147483647# `plusInteger` S# 1#)</span>
<a name="line-8"></a><span class='hs-cpp'>#elif SIZEOF_HSWORD == 8</span>
<a name="line-9"></a><span class='hs-cpp'>#define INT_MINBOUND (-9223372036854775808#)</span>
<a name="line-10"></a><span class='hs-cpp'>#define NEG_INT_MINBOUND (S# 9223372036854775807# `plusInteger` S# 1#)</span>
<a name="line-11"></a><span class='hs-cpp'>#else</span>
<a name="line-12"></a><span class='hs-cpp'>#error Unknown SIZEOF_HSWORD; can't define INT_MINBOUND and NEG_INT_MINBOUND</span>
<a name="line-13"></a><span class='hs-cpp'>#endif</span>
<a name="line-14"></a>
<a name="line-15"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Integer</span><span class='hs-varop'>.</span><span class='hs-conid'>Type</span> <span class='hs-keyword'>where</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Prim</span> <span class='hs-layout'>(</span>
<a name="line-18"></a>    <span class='hs-comment'>-- Other types we use, convert from, or convert to</span>
<a name="line-19"></a>    <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-20"></a>    <span class='hs-comment'>-- Conversions between those types</span>
<a name="line-21"></a>    <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>int2Double</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>int2Float</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-22"></a>    <span class='hs-comment'>-- Operations on Int# that we use for operations on S#</span>
<a name="line-23"></a>    <span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-24"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>==#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>/=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>*#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>-#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>+#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-25"></a>    <span class='hs-varid'>mulIntMayOflo</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>addIntC</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>subIntC</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-26"></a>    <span class='hs-varid'>and</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>or</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>xor</span><span class='hs-cpp'>#</span>
<a name="line-27"></a> <span class='hs-layout'>)</span>
<a name="line-28"></a>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Integer</span><span class='hs-varop'>.</span><span class='hs-conid'>GMP</span><span class='hs-varop'>.</span><span class='hs-conid'>Prim</span> <span class='hs-layout'>(</span>
<a name="line-30"></a>    <span class='hs-comment'>-- GMP-related primitives</span>
<a name="line-31"></a>    <span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-32"></a>    <span class='hs-varid'>plusInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>minusInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>timesInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-33"></a>    <span class='hs-varid'>quotRemInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>remInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>divModInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-34"></a>    <span class='hs-varid'>gcdInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>gcdIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>gcdInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>divExactInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-35"></a>    <span class='hs-varid'>decodeDouble</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-36"></a>    <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integer2Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-37"></a>    <span class='hs-varid'>andInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>orInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>xorInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>complementInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-38"></a>    <span class='hs-varid'>mul2ExpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>fdivQ2ExpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-39"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-40"></a>    <span class='hs-varid'>int64ToInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>  <span class='hs-varid'>integerToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-41"></a>    <span class='hs-varid'>word64ToInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integerToWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-42"></a><span class='hs-cpp'>#endif</span>
<a name="line-43"></a> <span class='hs-layout'>)</span>
<a name="line-44"></a>
<a name="line-45"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-46"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>IntWord64</span> <span class='hs-layout'>(</span>
<a name="line-47"></a>            <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-48"></a>            <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-49"></a>            <span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word64ToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-50"></a>            <span class='hs-varid'>geInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>leInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>leWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-51"></a>       <span class='hs-layout'>)</span>
<a name="line-52"></a><span class='hs-cpp'>#endif</span>
<a name="line-53"></a>
<a name="line-54"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Classes</span>
<a name="line-55"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-56"></a>
<a name="line-57"></a><span class='hs-keyword'>default</span> <span class='hs-conid'>()</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ type}
%*                                                      *
%*********************************************************

Convenient boxed Integer PrimOps.

\begin{code}
<pre><a name="line-1"></a><a name="Integer"></a><span class='hs-comment'>-- | Arbitrary-precision integers.</span>
<a name="line-2"></a><a name="Integer"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>                            <span class='hs-comment'>-- small integers</span>
<a name="line-4"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span>                 <span class='hs-comment'>-- large integers</span>
<a name="line-5"></a>
<a name="line-6"></a><a name="mkInteger"></a><span class='hs-definition'>mkInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>   <span class='hs-comment'>-- non-negative?</span>
<a name="line-7"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- absolute value in 31 bit chunks, least significant first</span>
<a name="line-8"></a>                    <span class='hs-comment'>-- ideally these would be Words rather than Ints, but</span>
<a name="line-9"></a>                    <span class='hs-comment'>-- we don't have Word available at the moment.</span>
<a name="line-10"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-11"></a><span class='hs-definition'>mkInteger</span> <span class='hs-varid'>nonNegative</span> <span class='hs-varid'>is</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>abs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>is</span>
<a name="line-12"></a>                           <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>nonNegative</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>abs</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>negateInteger</span> <span class='hs-varid'>abs</span>
<a name="line-13"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>f</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-14"></a>          <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-conop'>:</span> <span class='hs-varid'>is'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>is'</span><span class='hs-layout'>)</span> <span class='hs-num'>31</span><span class='hs-cpp'>#</span>
<a name="line-15"></a>
<a name="line-16"></a><a name="smallInteger"></a><span class='hs-comment'>{-# NOINLINE smallInteger #-}</span>
<a name="line-17"></a><span class='hs-definition'>smallInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-18"></a><span class='hs-definition'>smallInteger</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-19"></a>
<a name="line-20"></a><a name="wordToInteger"></a><span class='hs-comment'>{-# NOINLINE wordToInteger #-}</span>
<a name="line-21"></a><span class='hs-definition'>wordToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-22"></a><span class='hs-definition'>wordToInteger</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-23"></a>
<a name="line-24"></a><span class='hs-comment'>{-# RULES
<a name="line-25"></a>"integerToInt/smallInteger"   forall x . integerToInt  (smallInteger  x) = x
<a name="line-26"></a>"integerToWord/wordToInteger" forall x . integerToWord (wordToInteger x) = x
<a name="line-27"></a> #-}</span>
<a name="line-28"></a>
<a name="line-29"></a><a name="integerToWord"></a><span class='hs-comment'>{-# NOINLINE integerToWord #-}</span>
<a name="line-30"></a><span class='hs-definition'>integerToWord</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-31"></a><span class='hs-definition'>integerToWord</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-32"></a><span class='hs-definition'>integerToWord</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-33"></a>
<a name="line-34"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-35"></a><a name="integerToWord64"></a><span class='hs-comment'>{-# NOINLINE integerToWord64 #-}</span>
<a name="line-36"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span>
<a name="line-37"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-38"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToWord64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-39"></a>
<a name="line-40"></a><a name="word64ToInteger"></a><span class='hs-comment'>{-# NOINLINE word64ToInteger #-}</span>
<a name="line-41"></a><span class='hs-definition'>word64ToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-42"></a><span class='hs-definition'>word64ToInteger</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>w</span> <span class='hs-varop'>`</span><span class='hs-varid'>leWord64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-num'>0x7FFFFFFF</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-43"></a>                    <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word64ToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-44"></a>                    <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word64ToInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span> <span class='hs-keyword'>of</span>
<a name="line-45"></a>                         <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-46"></a>
<a name="line-47"></a><a name="integerToInt64"></a><span class='hs-comment'>{-# NOINLINE integerToInt64 #-}</span>
<a name="line-48"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span>
<a name="line-49"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-50"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-51"></a>
<a name="line-52"></a><a name="int64ToInteger"></a><span class='hs-comment'>{-# NOINLINE int64ToInteger #-}</span>
<a name="line-53"></a><span class='hs-definition'>int64ToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-54"></a><span class='hs-definition'>int64ToInteger</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>leInt64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-num'>0x7FFFFFFF</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span>
<a name="line-55"></a>                       <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>geInt64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>0x80000000</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-56"></a>                   <span class='hs-keyword'>then</span> <span class='hs-varid'>smallInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-57"></a>                   <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int64ToInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-58"></a>                        <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-59"></a>
<a name="line-60"></a><span class='hs-comment'>{-# RULES
<a name="line-61"></a>"integerToInt64/int64ToInteger"   forall x . integerToInt64  (int64ToInteger  x) = x
<a name="line-62"></a>"integerToWord64/word64ToInteger" forall x . integerToWord64 (word64ToInteger x) = x
<a name="line-63"></a> #-}</span>
<a name="line-64"></a><span class='hs-cpp'>#endif</span>
<a name="line-65"></a>
<a name="line-66"></a><a name="integerToInt"></a><span class='hs-definition'>integerToInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-67"></a><span class='hs-comment'>{-# NOINLINE integerToInt #-}</span>
<a name="line-68"></a><span class='hs-comment'>{-# RULES "integerToInt" forall i. integerToInt (S# i) = i #-}</span>
<a name="line-69"></a><span class='hs-comment'>-- Don't inline integerToInt, because it can't do much unless</span>
<a name="line-70"></a><span class='hs-comment'>-- it sees a (S# i), and inlining just creates fruitless</span>
<a name="line-71"></a><span class='hs-comment'>-- join points.  But we do need a RULE to get the constants</span>
<a name="line-72"></a><span class='hs-comment'>-- to work right:  1::Int had better optimise to (I# 1)!</span>
<a name="line-73"></a><span class='hs-definition'>integerToInt</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
<a name="line-74"></a><span class='hs-definition'>integerToInt</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-75"></a>
<a name="line-76"></a><a name="toBig"></a><span class='hs-definition'>toBig</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-77"></a><span class='hs-definition'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-layout'>}</span>
<a name="line-78"></a><span class='hs-definition'>toBig</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{Dividing @Integers@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>-- XXX There's no good reason for us using unboxed tuples for the</span>
<a name="line-2"></a><span class='hs-comment'>-- results, but we don't have Data.Tuple available.</span>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-comment'>-- Note that we don't check for divide-by-zero here. That needs</span>
<a name="line-5"></a><span class='hs-comment'>-- to be done where it's used.</span>
<a name="line-6"></a><span class='hs-comment'>-- (we don't have error)</span>
<a name="line-7"></a>
<a name="line-8"></a><a name="quotRemInteger"></a><span class='hs-comment'>{-# NOINLINE quotRemInteger #-}</span>
<a name="line-9"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-10"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-11"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-12"></a>    <span class='hs-keyword'>where</span>
<a name="line-13"></a>      <span class='hs-comment'>-- NB. don't inline these.  (# S# (i `quotInt#` j), ... #) means</span>
<a name="line-14"></a>      <span class='hs-comment'>-- (# let q = i `quotInt#` j in S# q, ... #) which builds a</span>
<a name="line-15"></a>      <span class='hs-comment'>-- useless thunk.  Placing the bindings here means they'll be</span>
<a name="line-16"></a>      <span class='hs-comment'>-- evaluated strictly.</span>
<a name="line-17"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>q</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>j</span>
<a name="line-18"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span>  <span class='hs-varid'>j</span>
<a name="line-19"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-20"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-21"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-22"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotRemInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-23"></a>          <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span><span class='hs-layout'>,</span> <span class='hs-varid'>d3</span><span class='hs-layout'>,</span> <span class='hs-varid'>s4</span><span class='hs-layout'>,</span> <span class='hs-varid'>d4</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-24"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>,</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s4</span> <span class='hs-varid'>d4</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-25"></a>
<a name="line-26"></a><a name="divModInteger"></a><span class='hs-comment'>{-# NOINLINE divModInteger #-}</span>
<a name="line-27"></a><span class='hs-definition'>divModInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-28"></a><span class='hs-definition'>divModInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-29"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-30"></a>    <span class='hs-keyword'>where</span>
<a name="line-31"></a>      <span class='hs-comment'>-- NB. don't inline these.  See quotRemInteger above.</span>
<a name="line-32"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>divInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>j</span>
<a name="line-33"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>modInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>j</span>
<a name="line-34"></a>
<a name="line-35"></a>      <span class='hs-comment'>-- XXX Copied from GHC.Base</span>
<a name="line-36"></a>      <span class='hs-varid'>divInt</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-37"></a>      <span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>`</span><span class='hs-varid'>divInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span>
<a name="line-38"></a>       <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>-#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>`</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>-#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-39"></a>         <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>+#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>`</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>-#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-40"></a>         <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>`</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span>
<a name="line-41"></a>
<a name="line-42"></a>      <span class='hs-varid'>modInt</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-43"></a>      <span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>`</span><span class='hs-varid'>modInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span>
<a name="line-44"></a>       <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>||</span>
<a name="line-45"></a>            <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-46"></a>         <span class='hs-keyword'>then</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>r</span><span class='hs-cpp'>#</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>r</span><span class='hs-cpp'>#</span> <span class='hs-varop'>+#</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>else</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-47"></a>         <span class='hs-keyword'>else</span> <span class='hs-varid'>r</span><span class='hs-cpp'>#</span>
<a name="line-48"></a>          <span class='hs-keyword'>where</span> <span class='hs-varop'>!</span><span class='hs-varid'>r</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span><span class='hs-cpp'>#</span> <span class='hs-varop'>`</span><span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>y</span><span class='hs-cpp'>#</span>
<a name="line-49"></a>
<a name="line-50"></a><span class='hs-definition'>divModInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-51"></a><span class='hs-definition'>divModInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-52"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-53"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>divModInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-54"></a>          <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span><span class='hs-layout'>,</span> <span class='hs-varid'>d3</span><span class='hs-layout'>,</span> <span class='hs-varid'>s4</span><span class='hs-layout'>,</span> <span class='hs-varid'>d4</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-55"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>,</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s4</span> <span class='hs-varid'>d4</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="remInteger"></a><span class='hs-comment'>{-# NOINLINE remInteger #-}</span>
<a name="line-58"></a><span class='hs-definition'>remInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-59"></a><span class='hs-definition'>remInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-60"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-61"></a><span class='hs-comment'>{- Special case doesn't work, because a 1-element J# has the range
<a name="line-62"></a>   -(2^32-1) -- 2^32-1, whereas S# has the range -2^31 -- (2^31-1)
<a name="line-63"></a>remInteger ia@(S# a) (J# sb b)
<a name="line-64"></a>  | sb ==# 1#  = S# (remInt# a (word2Int# (integer2Word# sb b)))
<a name="line-65"></a>  | sb ==# -1# = S# (remInt# a (0# -# (word2Int# (integer2Word# sb b))))
<a name="line-66"></a>  | 0# &lt;# sb   = ia
<a name="line-67"></a>  | otherwise  = S# (0# -# a)
<a name="line-68"></a>-}</span>
<a name="line-69"></a><span class='hs-definition'>remInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-70"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-71"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span><span class='hs-layout'>,</span> <span class='hs-varid'>b'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-72"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>remInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sr</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-73"></a>    <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sr</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span><span class='hs-layout'>}</span>
<a name="line-74"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-75"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>remInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sr</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sr</span> <span class='hs-varid'>r</span>
<a name="line-76"></a>
<a name="line-77"></a><a name="quotInteger"></a><span class='hs-comment'>{-# NOINLINE quotInteger #-}</span>
<a name="line-78"></a><span class='hs-definition'>quotInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-79"></a><span class='hs-definition'>quotInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-80"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-81"></a><span class='hs-comment'>{- Special case disabled, see remInteger above
<a name="line-82"></a>quotInteger (S# a) (J# sb b)
<a name="line-83"></a>  | sb ==# 1#  = S# (quotInt# a (word2Int# (integer2Word# sb b)))
<a name="line-84"></a>  | sb ==# -1# = S# (quotInt# a (0# -# (word2Int# (integer2Word# sb b))))
<a name="line-85"></a>  | otherwise  = S# 0
<a name="line-86"></a>-}</span>
<a name="line-87"></a><span class='hs-definition'>quotInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-88"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-89"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span><span class='hs-layout'>,</span> <span class='hs-varid'>b'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-90"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>quotInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sq</span><span class='hs-layout'>,</span> <span class='hs-varid'>q</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sq</span> <span class='hs-varid'>q</span> <span class='hs-layout'>}</span>
<a name="line-91"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-92"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>quotInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg</span> <span class='hs-varid'>g</span>
</pre>\end{code}



\begin{code}
<pre><a name="line-1"></a><a name="gcdInteger"></a><span class='hs-comment'>-- We can't throw an error here, so it is up to our caller to</span>
<a name="line-2"></a><span class='hs-comment'>-- not call us with both arguments being 0.</span>
<a name="line-3"></a><span class='hs-comment'>{-# NOINLINE gcdInteger #-}</span>
<a name="line-4"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-5"></a><span class='hs-comment'>-- SUP: Do we really need the first two cases?</span>
<a name="line-6"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-7"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-8"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdInt</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-9"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>  <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-10"></a> <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>a</span>  <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>ib</span>
<a name="line-11"></a>   <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>sb</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>ia</span>
<a name="line-12"></a>   <span class='hs-keyword'>else</span>                   <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>absSb</span> <span class='hs-varid'>b</span> <span class='hs-varid'>absA</span><span class='hs-layout'>)</span>
<a name="line-13"></a>       <span class='hs-keyword'>where</span> <span class='hs-varop'>!</span><span class='hs-varid'>absA</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>a</span>  <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span>  <span class='hs-keyword'>else</span> <span class='hs-varid'>a</span>
<a name="line-14"></a>             <span class='hs-varop'>!</span><span class='hs-varid'>absSb</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>sb</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>sb</span>
<a name="line-15"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>ib</span> <span class='hs-varid'>ia</span>
<a name="line-16"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-17"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>gcdInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg</span> <span class='hs-varid'>g</span>
<a name="line-18"></a>
<a name="line-19"></a><a name="lcmInteger"></a><span class='hs-comment'>{-# NOINLINE lcmInteger #-}</span>
<a name="line-20"></a><span class='hs-definition'>lcmInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-21"></a><span class='hs-definition'>lcmInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`eqInteger`</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-22"></a>                 <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`eqInteger`</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-23"></a>                 <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-varid'>divExact</span> <span class='hs-varid'>aa</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>aa</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>`timesInteger`</span> <span class='hs-varid'>ab</span>
<a name="line-24"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>aa</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>a</span>
<a name="line-25"></a>        <span class='hs-varid'>ab</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>b</span>
<a name="line-26"></a>
<a name="line-27"></a><a name="gcdInt"></a><span class='hs-comment'>{-# RULES "gcdInteger/Int" forall a b.
<a name="line-28"></a>            gcdInteger (S# a) (S# b) = S# (gcdInt a b)
<a name="line-29"></a>  #-}</span>
<a name="line-30"></a><span class='hs-definition'>gcdInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-31"></a><span class='hs-definition'>gcdInt</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInt</span> <span class='hs-varid'>y</span>
<a name="line-32"></a><span class='hs-definition'>gcdInt</span> <span class='hs-varid'>x</span>  <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInt</span> <span class='hs-varid'>x</span>
<a name="line-33"></a><span class='hs-definition'>gcdInt</span> <span class='hs-varid'>x</span>  <span class='hs-varid'>y</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>absInt</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>absInt</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="absInt"></a><span class='hs-definition'>absInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-36"></a><span class='hs-definition'>absInt</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-37"></a>
<a name="line-38"></a><a name="divExact"></a><span class='hs-definition'>divExact</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-39"></a><span class='hs-definition'>divExact</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divExact</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-40"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-41"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-42"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-43"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-44"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span>
<a name="line-45"></a>    <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span><span class='hs-layout'>,</span> <span class='hs-varid'>b'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>divExactInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b'</span> <span class='hs-keyword'>of</span>
<a name="line-46"></a>                    <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sd</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sd</span> <span class='hs-varid'>d</span>
<a name="line-47"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-48"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>divExactInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sd</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sd</span> <span class='hs-varid'>d</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ instances for @Eq@, @Ord@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="eqInteger"></a><span class='hs-comment'>{-# NOINLINE eqInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>eqInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-3"></a><span class='hs-definition'>eqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-varid'>j</span>
<a name="line-4"></a><span class='hs-definition'>eqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-5"></a><span class='hs-definition'>eqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-6"></a><span class='hs-definition'>eqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-7"></a>
<a name="line-8"></a><a name="neqInteger"></a><span class='hs-comment'>{-# NOINLINE neqInteger #-}</span>
<a name="line-9"></a><span class='hs-definition'>neqInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-10"></a><span class='hs-definition'>neqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-varid'>j</span>
<a name="line-11"></a><span class='hs-definition'>neqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-12"></a><span class='hs-definition'>neqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-13"></a><span class='hs-definition'>neqInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-14"></a>
<a name="line-15"></a><span class='hs-keyword'>instance</span>  <span class='hs-conid'>Eq</span> <span class='hs-conid'>Integer</span>  <span class='hs-keyword'>where</span>
<a name="line-16"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>eqInteger</span>
<a name="line-17"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>/=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>neqInteger</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-comment'>------------------------------------------------------------------------</span>
<a name="line-20"></a>
<a name="line-21"></a><a name="leInteger"></a><span class='hs-comment'>{-# NOINLINE leInteger #-}</span>
<a name="line-22"></a><span class='hs-definition'>leInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-23"></a><span class='hs-definition'>leInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-varid'>j</span>
<a name="line-24"></a><span class='hs-definition'>leInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-25"></a><span class='hs-definition'>leInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-26"></a><span class='hs-definition'>leInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-27"></a>
<a name="line-28"></a><a name="gtInteger"></a><span class='hs-comment'>{-# NOINLINE gtInteger #-}</span>
<a name="line-29"></a><span class='hs-definition'>gtInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-30"></a><span class='hs-definition'>gtInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-varid'>j</span>
<a name="line-31"></a><span class='hs-definition'>gtInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-32"></a><span class='hs-definition'>gtInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-33"></a><span class='hs-definition'>gtInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="ltInteger"></a><span class='hs-comment'>{-# NOINLINE ltInteger #-}</span>
<a name="line-36"></a><span class='hs-definition'>ltInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-37"></a><span class='hs-definition'>ltInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-varid'>j</span>
<a name="line-38"></a><span class='hs-definition'>ltInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-39"></a><span class='hs-definition'>ltInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-40"></a><span class='hs-definition'>ltInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-41"></a>
<a name="line-42"></a><a name="geInteger"></a><span class='hs-comment'>{-# NOINLINE geInteger #-}</span>
<a name="line-43"></a><span class='hs-definition'>geInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-44"></a><span class='hs-definition'>geInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-varid'>j</span>
<a name="line-45"></a><span class='hs-definition'>geInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-46"></a><span class='hs-definition'>geInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-47"></a><span class='hs-definition'>geInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-48"></a>
<a name="line-49"></a><a name="compareInteger"></a><span class='hs-comment'>{-# NOINLINE compareInteger #-}</span>
<a name="line-50"></a><span class='hs-definition'>compareInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ordering</span>
<a name="line-51"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>  <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-52"></a>   <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>EQ</span>
<a name="line-53"></a>     <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span>
<a name="line-54"></a>     <span class='hs-keyword'>else</span>                 <span class='hs-conid'>GT</span>
<a name="line-55"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-56"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-57"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-58"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-59"></a>     <span class='hs-layout'>}</span>
<a name="line-60"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-61"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-62"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-63"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-64"></a>     <span class='hs-layout'>}</span>
<a name="line-65"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-66"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-67"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-68"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-69"></a>     <span class='hs-layout'>}</span>
<a name="line-70"></a>
<a name="line-71"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-conid'>Integer</span> <span class='hs-keyword'>where</span>
<a name="line-72"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>leInteger</span>
<a name="line-73"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gtInteger</span>
<a name="line-74"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ltInteger</span>
<a name="line-75"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&gt;=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>geInteger</span>
<a name="line-76"></a>    <span class='hs-varid'>compare</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compareInteger</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ instances for @Num@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="absInteger"></a><span class='hs-comment'>{-# NOINLINE absInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>absInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a><span class='hs-definition'>absInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NEG_INT_MINBOUND</span>
<a name="line-4"></a><span class='hs-definition'>absInteger</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-5"></a><span class='hs-definition'>absInteger</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="signumInteger"></a><span class='hs-comment'>{-# NOINLINE signumInteger #-}</span>
<a name="line-8"></a><span class='hs-definition'>signumInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-9"></a><span class='hs-definition'>signumInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-10"></a>                       <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-11"></a>                       <span class='hs-keyword'>else</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-12"></a><span class='hs-definition'>signumInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-13"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span>
<a name="line-14"></a>        <span class='hs-varop'>!</span><span class='hs-varid'>cmp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-15"></a>    <span class='hs-keyword'>in</span>
<a name="line-16"></a>    <span class='hs-keyword'>if</span>      <span class='hs-varid'>cmp</span> <span class='hs-varop'>&gt;#</span>  <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-17"></a>    <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>cmp</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-18"></a>    <span class='hs-keyword'>else</span>                    <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-19"></a>
<a name="line-20"></a><a name="plusInteger"></a><span class='hs-comment'>{-# NOINLINE plusInteger #-}</span>
<a name="line-21"></a><span class='hs-definition'>plusInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-22"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>addIntC</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>of</span>
<a name="line-23"></a>                                   <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-24"></a>                                       <span class='hs-keyword'>if</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-25"></a>                                       <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span>
<a name="line-26"></a>                                       <span class='hs-keyword'>else</span> <span class='hs-varid'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-27"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plusInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-28"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-29"></a><span class='hs-definition'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>plusInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-30"></a>                                    <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-31"></a>
<a name="line-32"></a><a name="minusInteger"></a><span class='hs-comment'>{-# NOINLINE minusInteger #-}</span>
<a name="line-33"></a><span class='hs-definition'>minusInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-34"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>subIntC</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>of</span>
<a name="line-35"></a>                                     <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-36"></a>                                         <span class='hs-keyword'>if</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span>
<a name="line-37"></a>                                         <span class='hs-keyword'>else</span> <span class='hs-varid'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span>
<a name="line-38"></a>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-39"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minusInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-40"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-41"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>minusInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-42"></a>                                     <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-43"></a>
<a name="line-44"></a><a name="timesInteger"></a><span class='hs-comment'>{-# NOINLINE timesInteger #-}</span>
<a name="line-45"></a><span class='hs-definition'>timesInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-46"></a><span class='hs-definition'>timesInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>mulIntMayOflo</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-47"></a>                                     <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>*#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-48"></a>                                     <span class='hs-keyword'>else</span> <span class='hs-varid'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-49"></a><span class='hs-definition'>timesInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>timesInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-50"></a><span class='hs-definition'>timesInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-51"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>timesInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-52"></a>                                     <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-53"></a>
<a name="line-54"></a><a name="negateInteger"></a><span class='hs-comment'>{-# NOINLINE negateInteger #-}</span>
<a name="line-55"></a><span class='hs-definition'>negateInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-56"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NEG_INT_MINBOUND</span>
<a name="line-57"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-58"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ stuff for Double@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="encodeFloatInteger"></a><span class='hs-comment'>{-# NOINLINE encodeFloatInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-3"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int_encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span>
<a name="line-4"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span>
<a name="line-5"></a>
<a name="line-6"></a><a name="encodeDoubleInteger"></a><span class='hs-comment'>{-# NOINLINE encodeDoubleInteger #-}</span>
<a name="line-7"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-8"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int_encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span>
<a name="line-9"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="decodeDoubleInteger"></a><span class='hs-comment'>{-# NOINLINE decodeDoubleInteger #-}</span>
<a name="line-12"></a><span class='hs-definition'>decodeDoubleInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-13"></a><span class='hs-definition'>decodeDoubleInteger</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>decodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span> <span class='hs-keyword'>of</span>
<a name="line-14"></a>                        <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>exp</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>exp</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-15"></a>
<a name="line-16"></a><span class='hs-comment'>-- previous code: doubleFromInteger n = fromInteger n = encodeFloat n 0</span>
<a name="line-17"></a><span class='hs-comment'>-- doesn't work too well, because encodeFloat is defined in</span>
<a name="line-18"></a><span class='hs-comment'>-- terms of ccalls which can never be simplified away.  We</span>
<a name="line-19"></a><span class='hs-comment'>-- want simple literals like (fromInteger 3 :: Float) to turn</span>
<a name="line-20"></a><span class='hs-comment'>-- into (F# 3.0), hence the special case for S# here.</span>
<a name="line-21"></a>
<a name="line-22"></a><a name="doubleFromInteger"></a><span class='hs-comment'>{-# NOINLINE doubleFromInteger #-}</span>
<a name="line-23"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-24"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Double</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span>
<a name="line-25"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-26"></a>
<a name="line-27"></a><a name="floatFromInteger"></a><span class='hs-comment'>{-# NOINLINE floatFromInteger #-}</span>
<a name="line-28"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-29"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Float</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span>
<a name="line-30"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-31"></a>
<a name="line-32"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_cbits_encodeFloat"</span>
<a name="line-33"></a>        <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-34"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"__int_encodeFloat"</span>
<a name="line-35"></a>        <span class='hs-varid'>int_encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-36"></a>
<a name="line-37"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_cbits_encodeDouble"</span>
<a name="line-38"></a>        <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-39"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"__int_encodeDouble"</span>
<a name="line-40"></a>        <span class='hs-varid'>int_encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ Bit definitions@}
%*                                                      *
%*********************************************************

We explicitly pattern match against J# and S# in order to produce
Core that doesn't have pattern matching errors, as that would
introduce a spurious dependency to base.

\begin{code}
<pre><a name="line-1"></a><a name="andInteger"></a><span class='hs-comment'>{-# NOINLINE andInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>andInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a><a name="andInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>and</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-4"></a><a name="x"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span>
<a name="line-5"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-6"></a><a name="andInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-7"></a>     <span class='hs-keyword'>case</span> <span class='hs-varid'>andInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-8"></a>       <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="orInteger"></a><span class='hs-comment'>{-# NOINLINE orInteger #-}</span>
<a name="line-11"></a><span class='hs-definition'>orInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-12"></a><a name="orInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>or</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-13"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span>
<a name="line-14"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-15"></a><a name="orInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-16"></a>     <span class='hs-keyword'>case</span> <span class='hs-varid'>orInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-17"></a>       <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-18"></a>
<a name="line-19"></a><a name="xorInteger"></a><span class='hs-comment'>{-# NOINLINE xorInteger #-}</span>
<a name="line-20"></a><span class='hs-definition'>xorInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-21"></a><a name="xorInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>xor</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-22"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span>
<a name="line-23"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-24"></a><a name="xorInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-25"></a>     <span class='hs-keyword'>case</span> <span class='hs-varid'>xorInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span>
<a name="line-26"></a>       <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-27"></a>
<a name="line-28"></a><a name="complementInteger"></a><span class='hs-comment'>{-# NOINLINE complementInteger #-}</span>
<a name="line-29"></a><span class='hs-definition'>complementInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-30"></a><span class='hs-definition'>complementInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-31"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>xor</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varop'>-#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-32"></a><span class='hs-definition'>complementInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-33"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>complementInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>d'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span> <span class='hs-varid'>d'</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="shiftLInteger"></a><span class='hs-comment'>{-# NOINLINE shiftLInteger #-}</span>
<a name="line-36"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-37"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span>
<a name="line-38"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>mul2ExpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-39"></a>                           <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>d'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span> <span class='hs-varid'>d'</span>
<a name="line-40"></a>
<a name="line-41"></a><a name="shiftRInteger"></a><span class='hs-comment'>{-# NOINLINE shiftRInteger #-}</span>
<a name="line-42"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-43"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shiftRInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span>
<a name="line-44"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>fdivQ2ExpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-45"></a>                           <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>d'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span> <span class='hs-varid'>d'</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ hashing@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>-- This is used by hashUnique</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-comment'>-- | hashInteger returns the same value as 'fromIntegral', although in</span>
<a name="line-4"></a><span class='hs-comment'>-- unboxed form.  It might be a reasonable hash function for 'Integer', </span>
<a name="line-5"></a><span class='hs-comment'>-- given a suitable distribution of 'Integer' values.</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="hashInteger"></a><span class='hs-definition'>hashInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-8"></a><span class='hs-definition'>hashInteger</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToInt</span>
</pre>\end{code}

</body>
</html>
