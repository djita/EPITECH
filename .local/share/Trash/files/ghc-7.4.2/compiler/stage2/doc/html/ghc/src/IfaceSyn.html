<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>iface/IfaceSyn.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
%
% (c) The University of Glasgow 2006
% (c) The GRASP/AQUA Project, Glasgow University, 1993-1998
%

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>{-# OPTIONS -fno-warn-tabs #-}</span>
<a name="line-2"></a><span class='hs-comment'>-- The above warning supression flag is a temporary kludge.</span>
<a name="line-3"></a><span class='hs-comment'>-- While working on this module you are encouraged to remove it and</span>
<a name="line-4"></a><span class='hs-comment'>-- detab the module (please do the detabbing in a separate patch). See</span>
<a name="line-5"></a><span class='hs-comment'>--     <a href="http://hackage.haskell.org/trac/ghc/wiki/Commentary/CodingStyle#TabsvsSpaces">http://hackage.haskell.org/trac/ghc/wiki/Commentary/CodingStyle#TabsvsSpaces</a></span>
<a name="line-6"></a><span class='hs-comment'>-- for details</span>
<a name="line-7"></a>
<a name="line-8"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>IfaceSyn</span> <span class='hs-layout'>(</span>
<a name="line-9"></a>        <span class='hs-keyword'>module</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span>
<a name="line-10"></a>
<a name="line-11"></a>        <span class='hs-conid'>IfaceDecl</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceClassOp</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceAT</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceATDefault</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-12"></a>        <span class='hs-conid'>IfaceConDecl</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceConDecls</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-13"></a>        <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceAlt</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceLetBndr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-14"></a>        <span class='hs-conid'>IfaceBinding</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceConAlt</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-15"></a>        <span class='hs-conid'>IfaceIdInfo</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceIdDetails</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceUnfolding</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-16"></a>        <span class='hs-conid'>IfaceInfoItem</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceRule</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceAnnotation</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceAnnTarget</span><span class='hs-layout'>,</span>
<a name="line-17"></a>        <span class='hs-conid'>IfaceInst</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceFamInst</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceTickish</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-18"></a>
<a name="line-19"></a>        <span class='hs-comment'>-- Misc</span>
<a name="line-20"></a>        <span class='hs-varid'>ifaceDeclSubBndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>visibleIfConDecls</span><span class='hs-layout'>,</span>
<a name="line-21"></a>
<a name="line-22"></a>        <span class='hs-comment'>-- Free Names</span>
<a name="line-23"></a>        <span class='hs-varid'>freeNamesIfDecl</span><span class='hs-layout'>,</span> <span class='hs-varid'>freeNamesIfRule</span><span class='hs-layout'>,</span>
<a name="line-24"></a>
<a name="line-25"></a>        <span class='hs-comment'>-- Pretty printing</span>
<a name="line-26"></a>        <span class='hs-varid'>pprIfaceExpr</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceDeclHead</span>
<a name="line-27"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-28"></a>
<a name="line-29"></a><span class='hs-cpp'>#include "HsVersions.h"</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>IfaceType</span>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Demand</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Annotations</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Class</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>NameSet</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Name</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>CostCentre</span>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Literal</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>ForeignCall</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Serialized</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>BasicTypes</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Outputable</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>FastString</span>
<a name="line-44"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Module</span>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>TysWiredIn</span> <span class='hs-layout'>(</span> <span class='hs-varid'>eqTyConName</span> <span class='hs-layout'>)</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-keyword'>infixl</span> <span class='hs-num'>3</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
</pre>\end{code}


%************************************************************************
%*                                                                      *
    Data type declarations
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><a name="IfaceDecl"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceDecl</span>
<a name="line-2"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceId</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifName</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>
<a name="line-3"></a>              <span class='hs-varid'>ifType</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span>
<a name="line-4"></a>              <span class='hs-varid'>ifIdDetails</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdDetails</span><span class='hs-layout'>,</span>
<a name="line-5"></a>              <span class='hs-varid'>ifIdInfo</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdInfo</span> <span class='hs-layout'>}</span>
<a name="line-6"></a>
<a name="line-7"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceData</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifName</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- Type constructor</span>
<a name="line-8"></a>                <span class='hs-varid'>ifTyVars</span>     <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- Type variables</span>
<a name="line-9"></a>                <span class='hs-varid'>ifCtxt</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceContext</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- The "stupid theta"</span>
<a name="line-10"></a>                <span class='hs-varid'>ifCons</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceConDecls</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- Includes new/data info</span>
<a name="line-11"></a>                <span class='hs-varid'>ifRec</span>        <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RecFlag</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- Recursive or not?</span>
<a name="line-12"></a>                <span class='hs-varid'>ifGadtSyntax</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- True &lt;=&gt; declared using</span>
<a name="line-13"></a>                                                <span class='hs-comment'>-- GADT syntax</span>
<a name="line-14"></a>                <span class='hs-varid'>ifFamInst</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-15"></a>                                                <span class='hs-comment'>-- Just &lt;=&gt; instance of family</span>
<a name="line-16"></a>                                                <span class='hs-comment'>-- Invariant:</span>
<a name="line-17"></a>                                                <span class='hs-comment'>--   ifCons /= IfOpenDataTyCon</span>
<a name="line-18"></a>                                                <span class='hs-comment'>--   for family instances</span>
<a name="line-19"></a>    <span class='hs-layout'>}</span>
<a name="line-20"></a>
<a name="line-21"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSyn</span>  <span class='hs-layout'>{</span> <span class='hs-varid'>ifName</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Type constructor</span>
<a name="line-22"></a>                <span class='hs-varid'>ifTyVars</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- Type variables</span>
<a name="line-23"></a>                <span class='hs-varid'>ifSynKind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceKind</span><span class='hs-layout'>,</span>         <span class='hs-comment'>-- Kind of the *rhs* (not of the tycon)</span>
<a name="line-24"></a>                <span class='hs-varid'>ifSynRhs</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- Just rhs for an ordinary synonyn</span>
<a name="line-25"></a>                                                <span class='hs-comment'>-- Nothing for an open family</span>
<a name="line-26"></a>                <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-27"></a>                                                <span class='hs-comment'>-- Just &lt;=&gt; instance of family</span>
<a name="line-28"></a>                                                <span class='hs-comment'>-- Invariant: ifOpenSyn == False</span>
<a name="line-29"></a>                                                <span class='hs-comment'>--   for family instances</span>
<a name="line-30"></a>    <span class='hs-layout'>}</span>
<a name="line-31"></a>
<a name="line-32"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceClass</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifCtxt</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceContext</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- Context...</span>
<a name="line-33"></a>                 <span class='hs-varid'>ifName</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- Name of the class TyCon</span>
<a name="line-34"></a>                 <span class='hs-varid'>ifTyVars</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- Type variables</span>
<a name="line-35"></a>                 <span class='hs-varid'>ifFDs</span>     <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FunDep</span> <span class='hs-conid'>FastString</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- Functional dependencies</span>
<a name="line-36"></a>                 <span class='hs-varid'>ifATs</span>     <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceAT</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- Associated type families</span>
<a name="line-37"></a>                 <span class='hs-varid'>ifSigs</span>    <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceClassOp</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- Method signatures</span>
<a name="line-38"></a>                 <span class='hs-varid'>ifRec</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RecFlag</span>           <span class='hs-comment'>-- Is newtype/datatype associated</span>
<a name="line-39"></a>                                                <span class='hs-comment'>--   with the class recursive?</span>
<a name="line-40"></a>    <span class='hs-layout'>}</span>
<a name="line-41"></a>
<a name="line-42"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceForeign</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Needs expanding when we move</span>
<a name="line-43"></a>                                                <span class='hs-comment'>-- beyond .NET</span>
<a name="line-44"></a>                   <span class='hs-varid'>ifExtName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>FastString</span> <span class='hs-layout'>}</span>
<a name="line-45"></a>
<a name="line-46"></a><a name="IfaceClassOp"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceClassOp</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceClassOp</span> <span class='hs-conid'>OccName</span> <span class='hs-conid'>DefMethSpec</span> <span class='hs-conid'>IfaceType</span>
<a name="line-47"></a>        <span class='hs-comment'>-- Nothing    =&gt; no default method</span>
<a name="line-48"></a>        <span class='hs-comment'>-- Just False =&gt; ordinary polymorphic default method</span>
<a name="line-49"></a>        <span class='hs-comment'>-- Just True  =&gt; generic default method</span>
<a name="line-50"></a>
<a name="line-51"></a><a name="IfaceAT"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceAT</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAT</span> <span class='hs-conid'>IfaceDecl</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceATDefault</span><span class='hs-keyglyph'>]</span>
<a name="line-52"></a>        <span class='hs-comment'>-- Nothing =&gt; no default associated type instance</span>
<a name="line-53"></a>        <span class='hs-comment'>-- Just ds =&gt; default associated type instance from these templates</span>
<a name="line-54"></a>
<a name="line-55"></a><a name="IfaceATDefault"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceATDefault</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceATD</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span> <span class='hs-conid'>IfaceType</span>
<a name="line-56"></a>        <span class='hs-comment'>-- Each associated type default template is a triple of:</span>
<a name="line-57"></a>        <span class='hs-comment'>--   1. TyVars of the RHS and family arguments (including the class TVs)</span>
<a name="line-58"></a>        <span class='hs-comment'>--   3. The instantiated family arguments</span>
<a name="line-59"></a>        <span class='hs-comment'>--   2. The RHS of the synonym</span>
<a name="line-60"></a>
<a name="line-61"></a><a name="IfaceConDecls"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceConDecls</span>
<a name="line-62"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfAbstractTyCon</span> <span class='hs-conid'>Bool</span>        <span class='hs-comment'>-- c.f TyCon.AbstractTyCon</span>
<a name="line-63"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfOpenDataTyCon</span>             <span class='hs-comment'>-- Open data family</span>
<a name="line-64"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfDataTyCon</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceConDecl</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- data type decls</span>
<a name="line-65"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfNewTyCon</span>  <span class='hs-conid'>IfaceConDecl</span>    <span class='hs-comment'>-- newtype decls</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="visibleIfConDecls"></a><span class='hs-definition'>visibleIfConDecls</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceConDecls</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceConDecl</span><span class='hs-keyglyph'>]</span>
<a name="line-68"></a><span class='hs-definition'>visibleIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfAbstractTyCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-69"></a><span class='hs-definition'>visibleIfConDecls</span> <span class='hs-conid'>IfOpenDataTyCon</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-70"></a><span class='hs-definition'>visibleIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfDataTyCon</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cs</span>
<a name="line-71"></a><span class='hs-definition'>visibleIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfNewTyCon</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>c</span><span class='hs-keyglyph'>]</span>
<a name="line-72"></a>
<a name="line-73"></a><a name="IfaceConDecl"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceConDecl</span>
<a name="line-74"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfCon</span> <span class='hs-layout'>{</span>
<a name="line-75"></a>        <span class='hs-varid'>ifConOcc</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>,</span>                <span class='hs-comment'>-- Constructor name</span>
<a name="line-76"></a>        <span class='hs-varid'>ifConWrapper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>                   <span class='hs-comment'>-- True &lt;=&gt; has a wrapper</span>
<a name="line-77"></a>        <span class='hs-varid'>ifConInfix</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>                   <span class='hs-comment'>-- True &lt;=&gt; declared infix</span>
<a name="line-78"></a>        <span class='hs-varid'>ifConUnivTvs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- Universal tyvars</span>
<a name="line-79"></a>        <span class='hs-varid'>ifConExTvs</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- Existential tyvars</span>
<a name="line-80"></a>        <span class='hs-varid'>ifConEqSpec</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>OccName</span><span class='hs-layout'>,</span><span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- Equality contraints</span>
<a name="line-81"></a>        <span class='hs-varid'>ifConCtxt</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceContext</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Non-stupid context</span>
<a name="line-82"></a>        <span class='hs-varid'>ifConArgTys</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>            <span class='hs-comment'>-- Arg types</span>
<a name="line-83"></a>        <span class='hs-varid'>ifConFields</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>OccName</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>              <span class='hs-comment'>-- ...ditto... (field labels)</span>
<a name="line-84"></a>        <span class='hs-varid'>ifConStricts</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>HsBang</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>}</span>               <span class='hs-comment'>-- Empty (meaning all lazy),</span>
<a name="line-85"></a>                                                <span class='hs-comment'>-- or 1-1 corresp with arg tys</span>
<a name="line-86"></a>
<a name="line-87"></a><a name="IfaceInst"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceInst</span>
<a name="line-88"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceInst</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifInstCls</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfExtName</span><span class='hs-layout'>,</span>                <span class='hs-comment'>-- See comments with</span>
<a name="line-89"></a>                <span class='hs-varid'>ifInstTys</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceTyCon</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- the defn of Instance</span>
<a name="line-90"></a>                <span class='hs-varid'>ifDFun</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfExtName</span><span class='hs-layout'>,</span>                <span class='hs-comment'>-- The dfun</span>
<a name="line-91"></a>                <span class='hs-varid'>ifOFlag</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OverlapFlag</span><span class='hs-layout'>,</span>              <span class='hs-comment'>-- Overlap flag</span>
<a name="line-92"></a>                <span class='hs-varid'>ifInstOrph</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>OccName</span> <span class='hs-layout'>}</span>           <span class='hs-comment'>-- See Note [Orphans]</span>
<a name="line-93"></a>        <span class='hs-comment'>-- There's always a separate IfaceDecl for the DFun, which gives</span>
<a name="line-94"></a>        <span class='hs-comment'>-- its IdInfo with its full type and version number.</span>
<a name="line-95"></a>        <span class='hs-comment'>-- The instance declarations taken together have a version number,</span>
<a name="line-96"></a>        <span class='hs-comment'>-- and we don't want that to wobble gratuitously</span>
<a name="line-97"></a>        <span class='hs-comment'>-- If this instance decl is *used*, we'll record a usage on the dfun;</span>
<a name="line-98"></a>        <span class='hs-comment'>-- and if the head does not change it won't be used if it wasn't before</span>
<a name="line-99"></a>
<a name="line-100"></a><a name="IfaceFamInst"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceFamInst</span>
<a name="line-101"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFamInst</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifFamInstFam</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfExtName</span>                <span class='hs-comment'>-- Family tycon</span>
<a name="line-102"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>ifFamInstTys</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceTyCon</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- Rough match types</span>
<a name="line-103"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>ifFamInstTyCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span>          <span class='hs-comment'>-- Instance decl</span>
<a name="line-104"></a>                 <span class='hs-layout'>}</span>
<a name="line-105"></a>
<a name="line-106"></a><a name="IfaceRule"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceRule</span>
<a name="line-107"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceRule</span> <span class='hs-layout'>{</span>
<a name="line-108"></a>        <span class='hs-varid'>ifRuleName</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RuleName</span><span class='hs-layout'>,</span>
<a name="line-109"></a>        <span class='hs-varid'>ifActivation</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Activation</span><span class='hs-layout'>,</span>
<a name="line-110"></a>        <span class='hs-varid'>ifRuleBndrs</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- Tyvars and term vars</span>
<a name="line-111"></a>        <span class='hs-varid'>ifRuleHead</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfExtName</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- Head of lhs</span>
<a name="line-112"></a>        <span class='hs-varid'>ifRuleArgs</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceExpr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- Args of LHS</span>
<a name="line-113"></a>        <span class='hs-varid'>ifRuleRhs</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>,</span>
<a name="line-114"></a>        <span class='hs-varid'>ifRuleAuto</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>
<a name="line-115"></a>        <span class='hs-varid'>ifRuleOrph</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>OccName</span>   <span class='hs-comment'>-- Just like IfaceInst</span>
<a name="line-116"></a>    <span class='hs-layout'>}</span>
<a name="line-117"></a>
<a name="line-118"></a><a name="IfaceAnnotation"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceAnnotation</span>
<a name="line-119"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAnnotation</span> <span class='hs-layout'>{</span>
<a name="line-120"></a>        <span class='hs-varid'>ifAnnotatedTarget</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAnnTarget</span><span class='hs-layout'>,</span>
<a name="line-121"></a>        <span class='hs-varid'>ifAnnotatedValue</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Serialized</span>
<a name="line-122"></a>  <span class='hs-layout'>}</span>
<a name="line-123"></a>
<a name="line-124"></a><a name="IfaceAnnTarget"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceAnnTarget</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnTarget</span> <span class='hs-conid'>OccName</span>
<a name="line-125"></a>
<a name="line-126"></a><span class='hs-comment'>-- We only serialise the IdDetails of top-level Ids, and even then</span>
<a name="line-127"></a><span class='hs-comment'>-- we only need a very limited selection.  Notably, none of the</span>
<a name="line-128"></a><span class='hs-comment'>-- implicit ones are needed here, becuase they are not put it</span>
<a name="line-129"></a><span class='hs-comment'>-- interface files</span>
<a name="line-130"></a>
<a name="line-131"></a><a name="IfaceIdDetails"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceIdDetails</span>
<a name="line-132"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfVanillaId</span>
<a name="line-133"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfRecSelId</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-conid'>Bool</span>
<a name="line-134"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfDFunId</span> 
<a name="line-135"></a>
<a name="line-136"></a><a name="IfaceIdInfo"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceIdInfo</span>
<a name="line-137"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoInfo</span>                      <span class='hs-comment'>-- When writing interface file without -O</span>
<a name="line-138"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HasInfo</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceInfoItem</span><span class='hs-keyglyph'>]</span>     <span class='hs-comment'>-- Has info, and here it is</span>
<a name="line-139"></a>
<a name="line-140"></a><span class='hs-comment'>-- Here's a tricky case:</span>
<a name="line-141"></a><span class='hs-comment'>--   * Compile with -O module A, and B which imports A.f</span>
<a name="line-142"></a><span class='hs-comment'>--   * Change function f in A, and recompile without -O</span>
<a name="line-143"></a><span class='hs-comment'>--   * When we read in old A.hi we read in its IdInfo (as a thunk)</span>
<a name="line-144"></a><span class='hs-comment'>--      (In earlier GHCs we used to drop IdInfo immediately on reading,</span>
<a name="line-145"></a><span class='hs-comment'>--       but we do not do that now.  Instead it's discarded when the</span>
<a name="line-146"></a><span class='hs-comment'>--       ModIface is read into the various decl pools.)</span>
<a name="line-147"></a><span class='hs-comment'>--   * The version comparsion sees that new (=NoInfo) differs from old (=HasInfo *)</span>
<a name="line-148"></a><span class='hs-comment'>--      and so gives a new version.</span>
<a name="line-149"></a>
<a name="line-150"></a><a name="IfaceInfoItem"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceInfoItem</span>
<a name="line-151"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsArity</span>      <span class='hs-conid'>Arity</span>
<a name="line-152"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HsStrictness</span> <span class='hs-conid'>StrictSig</span>
<a name="line-153"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HsInline</span>     <span class='hs-conid'>InlinePragma</span>
<a name="line-154"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HsUnfold</span>     <span class='hs-conid'>Bool</span>             <span class='hs-comment'>-- True &lt;=&gt; isStrongLoopBreaker is true</span>
<a name="line-155"></a>                 <span class='hs-conid'>IfaceUnfolding</span>   <span class='hs-comment'>-- See Note [Expose recursive functions]</span>
<a name="line-156"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HsNoCafRefs</span>
<a name="line-157"></a>
<a name="line-158"></a><span class='hs-comment'>-- NB: Specialisations and rules come in separately and are</span>
<a name="line-159"></a><span class='hs-comment'>-- only later attached to the Id.  Partial reason: some are orphans.</span>
<a name="line-160"></a>
<a name="line-161"></a><a name="IfaceUnfolding"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceUnfolding</span>
<a name="line-162"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfCoreUnfold</span> <span class='hs-conid'>Bool</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-comment'>-- True &lt;=&gt; INLINABLE, False &lt;=&gt; regular unfolding</span>
<a name="line-163"></a>                                <span class='hs-comment'>-- Possibly could eliminate the Bool here, the information</span>
<a name="line-164"></a>                                <span class='hs-comment'>-- is also in the InlinePragma.</span>
<a name="line-165"></a>
<a name="line-166"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfCompulsory</span> <span class='hs-conid'>IfaceExpr</span>      <span class='hs-comment'>-- Only used for default methods, in fact</span>
<a name="line-167"></a>
<a name="line-168"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfInlineRule</span> <span class='hs-conid'>Arity</span>          <span class='hs-comment'>-- INLINE pragmas</span>
<a name="line-169"></a>                 <span class='hs-conid'>Bool</span>           <span class='hs-comment'>-- OK to inline even if *un*-saturated</span>
<a name="line-170"></a>                 <span class='hs-conid'>Bool</span>           <span class='hs-comment'>-- OK to inline even if context is boring</span>
<a name="line-171"></a>                 <span class='hs-conid'>IfaceExpr</span>
<a name="line-172"></a>
<a name="line-173"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfExtWrapper</span> <span class='hs-conid'>Arity</span> <span class='hs-conid'>IfExtName</span>  <span class='hs-comment'>-- NB: sometimes we need a IfExtName (not just IfLclName)</span>
<a name="line-174"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfLclWrapper</span> <span class='hs-conid'>Arity</span> <span class='hs-conid'>IfLclName</span>  <span class='hs-comment'>--     because the worker can simplify to a function in</span>
<a name="line-175"></a>                                  <span class='hs-comment'>--     another module.</span>
<a name="line-176"></a>
<a name="line-177"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfDFunUnfold</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceExpr</span><span class='hs-keyglyph'>]</span>
<a name="line-178"></a>
<a name="line-179"></a><a name="IfaceExpr"></a><span class='hs-comment'>--------------------------------</span>
<a name="line-180"></a><a name="IfaceExpr"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceExpr</span>
<a name="line-181"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceLcl</span>    <span class='hs-conid'>IfLclName</span>
<a name="line-182"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceExt</span>    <span class='hs-conid'>IfExtName</span>
<a name="line-183"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceType</span>   <span class='hs-conid'>IfaceType</span>
<a name="line-184"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCo</span>     <span class='hs-conid'>IfaceType</span>		<span class='hs-comment'>-- We re-use IfaceType for coercions</span>
<a name="line-185"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTuple</span> 	<span class='hs-conid'>TupleSort</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceExpr</span><span class='hs-keyglyph'>]</span>	<span class='hs-comment'>-- Saturated; type arguments omitted</span>
<a name="line-186"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLam</span> 	<span class='hs-conid'>IfaceBndr</span> <span class='hs-conid'>IfaceExpr</span>
<a name="line-187"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceApp</span> 	<span class='hs-conid'>IfaceExpr</span> <span class='hs-conid'>IfaceExpr</span>
<a name="line-188"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCase</span>	<span class='hs-conid'>IfaceExpr</span> <span class='hs-conid'>IfLclName</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceAlt</span><span class='hs-keyglyph'>]</span>
<a name="line-189"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLet</span>	<span class='hs-conid'>IfaceBinding</span>  <span class='hs-conid'>IfaceExpr</span>
<a name="line-190"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCast</span>   <span class='hs-conid'>IfaceExpr</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-191"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLit</span>    <span class='hs-conid'>Literal</span>
<a name="line-192"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceFCall</span>  <span class='hs-conid'>ForeignCall</span> <span class='hs-conid'>IfaceType</span>
<a name="line-193"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTick</span>   <span class='hs-conid'>IfaceTickish</span> <span class='hs-conid'>IfaceExpr</span>    <span class='hs-comment'>-- from Tick tickish E</span>
<a name="line-194"></a>
<a name="line-195"></a><a name="IfaceTickish"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceTickish</span>
<a name="line-196"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceHpcTick</span> <span class='hs-conid'>Module</span> <span class='hs-conid'>Int</span>                <span class='hs-comment'>-- from HpcTick x</span>
<a name="line-197"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSCC</span>     <span class='hs-conid'>CostCentre</span> <span class='hs-conid'>Bool</span> <span class='hs-conid'>Bool</span>      <span class='hs-comment'>-- from ProfNote</span>
<a name="line-198"></a>  <span class='hs-comment'>-- no breakpoints: we never export these into interface files</span>
<a name="line-199"></a>
<a name="line-200"></a><a name="IfaceAlt"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceAlt</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceConAlt</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfLclName</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>)</span>
<a name="line-201"></a>        <span class='hs-comment'>-- Note: IfLclName, not IfaceBndr (and same with the case binder)</span>
<a name="line-202"></a>        <span class='hs-comment'>-- We reconstruct the kind/type of the thing from the context</span>
<a name="line-203"></a>        <span class='hs-comment'>-- thus saving bulk in interface files</span>
<a name="line-204"></a>
<a name="line-205"></a><a name="IfaceConAlt"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceConAlt</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceDefault</span>
<a name="line-206"></a>                 <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceDataAlt</span> <span class='hs-conid'>IfExtName</span>
<a name="line-207"></a>                 <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLitAlt</span> <span class='hs-conid'>Literal</span>
<a name="line-208"></a>
<a name="line-209"></a><a name="IfaceBinding"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceBinding</span>
<a name="line-210"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceNonRec</span> <span class='hs-conid'>IfaceLetBndr</span> <span class='hs-conid'>IfaceExpr</span>
<a name="line-211"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceRec</span>    <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceLetBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-212"></a>
<a name="line-213"></a><a name="IfaceLetBndr"></a><span class='hs-comment'>-- IfaceLetBndr is like IfaceIdBndr, but has IdInfo too</span>
<a name="line-214"></a><a name="IfaceLetBndr"></a><span class='hs-comment'>-- It's used for *non-top-level* let/rec binders</span>
<a name="line-215"></a><a name="IfaceLetBndr"></a><span class='hs-comment'>-- See Note [IdInfo on nested let-bindings]</span>
<a name="line-216"></a><a name="IfaceLetBndr"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceLetBndr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfLetBndr</span> <span class='hs-conid'>IfLclName</span> <span class='hs-conid'>IfaceType</span> <span class='hs-conid'>IfaceIdInfo</span>
</pre>\end{code}

Note [Expose recursive functions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For supercompilation we want to put *all* unfoldings in the interface
file, even for functions that are recursive (or big).  So we need to
know when an unfolding belongs to a loop-breaker so that we can refrain
from inlining it (except during supercompilation).

Note [IdInfo on nested let-bindings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Occasionally we want to preserve IdInfo on nested let bindings. The one
that came up was a NOINLINE pragma on a let-binding inside an INLINE
function.  The user (Duncan Coutts) really wanted the NOINLINE control
to cross the separate compilation boundary.

In general we retain all info that is left by CoreTidy.tidyLetBndr, since
that is what is seen by importing module with --make

Note [Orphans]: the ifInstOrph and ifRuleOrph fields
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If a module contains any "orphans", then its interface file is read
regardless, so that its instances are not missed. 

 - If an instance is an orphan its ifInstOprh field is Nothing
   Otherwise ifInstOrph is (Just n) where n is the Name of a
   local class or tycon that witnesses its non-orphan-hood.
   This computation is done by MkIface.instanceToIfaceInst

 - Similarly for ifRuleOrph
   The computation is done by MkIface.coreRuleToIfaceRule

Roughly speaking, an instance is an orphan if its head (after the =>)
mentions nothing defined in this module.  Functional dependencies
complicate the situation though. Consider

  module M where { class C a b | a -> b }

and suppose we are compiling module X:

  module X where
        import M
        data T = ...
        instance C Int T where ...

This instance is an orphan, because when compiling a third module Y we
might get a constraint (C Int v), and we'd want to improve v to T.  So
we must make sure X's instances are loaded, even if we do not directly
use anything from X.

More precisely, an instance is an orphan iff

  If there are no fundeps, then at least of the names in
  the instance head is locally defined.

  If there are fundeps, then for every fundep, at least one of the
  names free in a *non-determined* part of the instance head is
  defined in this module.

(Note that these conditions hold trivially if the class is locally
defined.)

Note [Versioning of instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See [http://hackage.haskell.org/trac/ghc/wiki/Commentary/Compiler/RecompilationAvoidance#Instances]

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>-- -----------------------------------------------------------------------------</span>
<a name="line-2"></a><span class='hs-comment'>-- Utils on IfaceSyn</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="ifaceDeclSubBndrs"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceDecl</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>OccName</span><span class='hs-keyglyph'>]</span>
<a name="line-5"></a><span class='hs-comment'>--  *Excludes* the 'main' name, but *includes* the implicitly-bound names</span>
<a name="line-6"></a><span class='hs-comment'>-- Deeply revolting, because it has to predict what gets bound,</span>
<a name="line-7"></a><span class='hs-comment'>-- especially the question of whether there's a wrapper for a datacon</span>
<a name="line-8"></a>
<a name="line-9"></a><span class='hs-comment'>-- N.B. the set of names returned here *must* match the set of</span>
<a name="line-10"></a><span class='hs-comment'>-- TyThings returned by HscTypes.implicitTyThings, in the sense that</span>
<a name="line-11"></a><span class='hs-comment'>-- TyThing.getOccName should define a bijection between the two lists.</span>
<a name="line-12"></a><span class='hs-comment'>-- This invariant is used in LoadIface.loadDecl (see note [Tricky iface loop])</span>
<a name="line-13"></a><span class='hs-comment'>-- The order of the list does not matter.</span>
<a name="line-14"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-conid'>IfaceData</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifCons</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfAbstractTyCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-15"></a>
<a name="line-16"></a><span class='hs-comment'>-- Newtype</span>
<a name="line-17"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceData</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_occ</span><span class='hs-layout'>,</span>
<a name="line-18"></a>                              <span class='hs-varid'>ifCons</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfNewTyCon</span> <span class='hs-layout'>(</span>
<a name="line-19"></a>                                        <span class='hs-conid'>IfCon</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifConOcc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>con_occ</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-20"></a>                              <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>famInst</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-21"></a>  <span class='hs-keyglyph'>=</span>   <span class='hs-comment'>-- implicit coerion and (possibly) family instance coercion</span>
<a name="line-22"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>mkNewTyCoOcc</span> <span class='hs-varid'>tc_occ</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-varid'>famInstCo</span> <span class='hs-varid'>famInst</span> <span class='hs-varid'>tc_occ</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span>
<a name="line-23"></a>      <span class='hs-comment'>-- data constructor and worker (newtypes don't have a wrapper)</span>
<a name="line-24"></a>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>con_occ</span><span class='hs-layout'>,</span> <span class='hs-varid'>mkDataConWorkerOcc</span> <span class='hs-varid'>con_occ</span><span class='hs-keyglyph'>]</span>
<a name="line-25"></a>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceData</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_occ</span><span class='hs-layout'>,</span>
<a name="line-28"></a>                              <span class='hs-varid'>ifCons</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfDataTyCon</span> <span class='hs-varid'>cons</span><span class='hs-layout'>,</span>
<a name="line-29"></a>                              <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>famInst</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-30"></a>  <span class='hs-keyglyph'>=</span>   <span class='hs-comment'>-- (possibly) family instance coercion;</span>
<a name="line-31"></a>      <span class='hs-comment'>-- there is no implicit coercion for non-newtypes</span>
<a name="line-32"></a>    <span class='hs-varid'>famInstCo</span> <span class='hs-varid'>famInst</span> <span class='hs-varid'>tc_occ</span>
<a name="line-33"></a>      <span class='hs-comment'>-- for each data constructor in order,</span>
<a name="line-34"></a>      <span class='hs-comment'>--    data constructor, worker, and (possibly) wrapper</span>
<a name="line-35"></a>    <span class='hs-varop'>++</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>dc_occs</span> <span class='hs-varid'>cons</span>
<a name="line-36"></a>  <span class='hs-keyword'>where</span>
<a name="line-37"></a>    <span class='hs-varid'>dc_occs</span> <span class='hs-varid'>con_decl</span>
<a name="line-38"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>has_wrapper</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>con_occ</span><span class='hs-layout'>,</span> <span class='hs-varid'>work_occ</span><span class='hs-layout'>,</span> <span class='hs-varid'>wrap_occ</span><span class='hs-keyglyph'>]</span>
<a name="line-39"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>con_occ</span><span class='hs-layout'>,</span> <span class='hs-varid'>work_occ</span><span class='hs-keyglyph'>]</span>
<a name="line-40"></a>        <span class='hs-keyword'>where</span>
<a name="line-41"></a>          <span class='hs-varid'>con_occ</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifConOcc</span> <span class='hs-varid'>con_decl</span>            <span class='hs-comment'>-- DataCon namespace</span>
<a name="line-42"></a>          <span class='hs-varid'>wrap_occ</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataConWrapperOcc</span> <span class='hs-varid'>con_occ</span>  <span class='hs-comment'>-- Id namespace</span>
<a name="line-43"></a>          <span class='hs-varid'>work_occ</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataConWorkerOcc</span> <span class='hs-varid'>con_occ</span>   <span class='hs-comment'>-- Id namespace</span>
<a name="line-44"></a>          <span class='hs-varid'>has_wrapper</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifConWrapper</span> <span class='hs-varid'>con_decl</span>     <span class='hs-comment'>-- This is the reason for</span>
<a name="line-45"></a>                                                  <span class='hs-comment'>-- having the ifConWrapper field!</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceClass</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifCtxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sc_ctxt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cls_tc_occ</span><span class='hs-layout'>,</span>
<a name="line-48"></a>                               <span class='hs-varid'>ifSigs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sigs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifATs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ats</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-49"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-comment'>--   (possibly) newtype coercion</span>
<a name="line-50"></a>    <span class='hs-varid'>co_occs</span> <span class='hs-varop'>++</span>
<a name="line-51"></a>    <span class='hs-comment'>--    data constructor (DataCon namespace)</span>
<a name="line-52"></a>    <span class='hs-comment'>--    data worker (Id namespace)</span>
<a name="line-53"></a>    <span class='hs-comment'>--    no wrapper (class dictionaries never have a wrapper)</span>
<a name="line-54"></a>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>dc_occ</span><span class='hs-layout'>,</span> <span class='hs-varid'>dcww_occ</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span>
<a name="line-55"></a>    <span class='hs-comment'>-- associated types</span>
<a name="line-56"></a>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>ifName</span> <span class='hs-varid'>at</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceAT</span> <span class='hs-varid'>at</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ats</span> <span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span>
<a name="line-57"></a>    <span class='hs-comment'>-- superclass selectors</span>
<a name="line-58"></a>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>mkSuperDictSelOcc</span> <span class='hs-varid'>n</span> <span class='hs-varid'>cls_tc_occ</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>n_ctxt</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span>
<a name="line-59"></a>    <span class='hs-comment'>-- operation selectors</span>
<a name="line-60"></a>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>op</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceClassOp</span> <span class='hs-varid'>op</span>  <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sigs</span><span class='hs-keyglyph'>]</span>
<a name="line-61"></a>  <span class='hs-keyword'>where</span>
<a name="line-62"></a>    <span class='hs-varid'>n_ctxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-varid'>sc_ctxt</span>
<a name="line-63"></a>    <span class='hs-varid'>n_sigs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-varid'>sigs</span>
<a name="line-64"></a>    <span class='hs-varid'>co_occs</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>is_newtype</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>mkNewTyCoOcc</span> <span class='hs-varid'>cls_tc_occ</span><span class='hs-keyglyph'>]</span>
<a name="line-65"></a>            <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-66"></a>    <span class='hs-varid'>dcww_occ</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataConWorkerOcc</span> <span class='hs-varid'>dc_occ</span>
<a name="line-67"></a>    <span class='hs-varid'>dc_occ</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkClassDataConOcc</span> <span class='hs-varid'>cls_tc_occ</span>
<a name="line-68"></a>    <span class='hs-varid'>is_newtype</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n_sigs</span> <span class='hs-varop'>+</span> <span class='hs-varid'>n_ctxt</span> <span class='hs-varop'>==</span> <span class='hs-num'>1</span> <span class='hs-comment'>-- Sigh</span>
<a name="line-69"></a>
<a name="line-70"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSyn</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_occ</span><span class='hs-layout'>,</span>
<a name="line-71"></a>                             <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>famInst</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-72"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>famInstCo</span> <span class='hs-varid'>famInst</span> <span class='hs-varid'>tc_occ</span>
<a name="line-73"></a>
<a name="line-74"></a><span class='hs-definition'>ifaceDeclSubBndrs</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-75"></a>
<a name="line-76"></a><a name="famInstCo"></a><span class='hs-comment'>-- coercion for data/newtype family instances</span>
<a name="line-77"></a><span class='hs-definition'>famInstCo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>OccName</span><span class='hs-keyglyph'>]</span>
<a name="line-78"></a><span class='hs-definition'>famInstCo</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-79"></a><span class='hs-definition'>famInstCo</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>baseOcc</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>mkInstTyCoOcc</span> <span class='hs-varid'>baseOcc</span><span class='hs-keyglyph'>]</span>
<a name="line-80"></a>
<a name="line-81"></a><span class='hs-comment'>----------------------------- Printing IfaceDecl ------------------------------</span>
<a name="line-82"></a>
<a name="line-83"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceDecl</span> <span class='hs-keyword'>where</span>
<a name="line-84"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceDecl</span>
<a name="line-85"></a>
<a name="line-86"></a><a name="pprIfaceDecl"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceDecl</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-87"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceId</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>var</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span><span class='hs-layout'>,</span>
<a name="line-88"></a>                       <span class='hs-varid'>ifIdDetails</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>details</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifIdInfo</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>info</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-89"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>var</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>,</span>
<a name="line-90"></a>          <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>details</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-91"></a>          <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-92"></a>
<a name="line-93"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForeign</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-94"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"foreign import type dotnet"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tycon</span><span class='hs-keyglyph'>]</span>
<a name="line-95"></a>
<a name="line-96"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSyn</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifTyVars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>,</span>
<a name="line-97"></a>                        <span class='hs-varid'>ifSynRhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>mono_ty</span><span class='hs-layout'>,</span>
<a name="line-98"></a>                        <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mbFamInst</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-99"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"type"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceDeclHead</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>tycon</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>)</span>
<a name="line-100"></a>       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>mono_ty</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprFamily</span> <span class='hs-varid'>mbFamInst</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-101"></a>
<a name="line-102"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSyn</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifTyVars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>,</span>
<a name="line-103"></a>                        <span class='hs-varid'>ifSynRhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifSynKind</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>kind</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-104"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"type family"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceDeclHead</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>tycon</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>)</span>
<a name="line-105"></a>       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>kind</span><span class='hs-layout'>)</span>
<a name="line-106"></a>
<a name="line-107"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceData</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifCtxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>context</span><span class='hs-layout'>,</span>
<a name="line-108"></a>                         <span class='hs-varid'>ifTyVars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifCons</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>condecls</span><span class='hs-layout'>,</span>
<a name="line-109"></a>                         <span class='hs-varid'>ifRec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mbFamInst</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-110"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp_nd</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceDeclHead</span> <span class='hs-varid'>context</span> <span class='hs-varid'>tycon</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>)</span>
<a name="line-111"></a>       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprRec</span> <span class='hs-varid'>isrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_condecls</span> <span class='hs-varid'>tycon</span> <span class='hs-varid'>condecls</span><span class='hs-layout'>,</span>
<a name="line-112"></a>                <span class='hs-varid'>pprFamily</span> <span class='hs-varid'>mbFamInst</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-113"></a>  <span class='hs-keyword'>where</span>
<a name="line-114"></a>    <span class='hs-varid'>pp_nd</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>condecls</span> <span class='hs-keyword'>of</span>
<a name="line-115"></a>                <span class='hs-conid'>IfAbstractTyCon</span> <span class='hs-varid'>dis</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"abstract"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>dis</span><span class='hs-layout'>)</span>
<a name="line-116"></a>                <span class='hs-conid'>IfOpenDataTyCon</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"data family"</span><span class='hs-layout'>)</span>
<a name="line-117"></a>                <span class='hs-conid'>IfDataTyCon</span> <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"data"</span><span class='hs-layout'>)</span>
<a name="line-118"></a>                <span class='hs-conid'>IfNewTyCon</span> <span class='hs-keyword'>_</span>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"newtype"</span><span class='hs-layout'>)</span>
<a name="line-119"></a>
<a name="line-120"></a><span class='hs-definition'>pprIfaceDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceClass</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifCtxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>context</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>clas</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifTyVars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyvars</span><span class='hs-layout'>,</span>
<a name="line-121"></a>                          <span class='hs-varid'>ifFDs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fds</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifATs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ats</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifSigs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sigs</span><span class='hs-layout'>,</span>
<a name="line-122"></a>                          <span class='hs-varid'>ifRec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isrec</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-123"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"class"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceDeclHead</span> <span class='hs-varid'>context</span> <span class='hs-varid'>clas</span> <span class='hs-varid'>tyvars</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprFundeps</span> <span class='hs-varid'>fds</span><span class='hs-layout'>)</span>
<a name="line-124"></a>       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprRec</span> <span class='hs-varid'>isrec</span><span class='hs-layout'>,</span>
<a name="line-125"></a>                <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ats</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-126"></a>                <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>sigs</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="pprRec"></a><span class='hs-definition'>pprRec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RecFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-129"></a><span class='hs-definition'>pprRec</span> <span class='hs-varid'>isrec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"RecFlag"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>isrec</span>
<a name="line-130"></a>
<a name="line-131"></a><a name="pprFamily"></a><span class='hs-definition'>pprFamily</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-132"></a><span class='hs-definition'>pprFamily</span> <span class='hs-conid'>Nothing</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"FamilyInstance: none"</span><span class='hs-layout'>)</span>
<a name="line-133"></a><span class='hs-definition'>pprFamily</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>famInst</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"FamilyInstance:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>famInst</span>
<a name="line-134"></a>
<a name="line-135"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceClassOp</span> <span class='hs-keyword'>where</span>
<a name="line-136"></a>   <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceClassOp</span> <span class='hs-varid'>n</span> <span class='hs-varid'>dm</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>dm</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-137"></a>
<a name="line-138"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceAT</span> <span class='hs-keyword'>where</span>
<a name="line-139"></a>   <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAT</span> <span class='hs-varid'>d</span> <span class='hs-varid'>defs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>defs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-140"></a>
<a name="line-141"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceATDefault</span> <span class='hs-keyword'>where</span>
<a name="line-142"></a>   <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceATD</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>pat_tys</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tvs</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat_tys</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'='</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-143"></a>
<a name="line-144"></a><a name="pprIfaceDeclHead"></a><span class='hs-definition'>pprIfaceDeclHead</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceContext</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-145"></a><span class='hs-definition'>pprIfaceDeclHead</span> <span class='hs-varid'>context</span> <span class='hs-varid'>thing</span> <span class='hs-varid'>tyvars</span>
<a name="line-146"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprIfaceContext</span> <span class='hs-varid'>context</span><span class='hs-layout'>,</span> <span class='hs-varid'>parenSymOcc</span> <span class='hs-varid'>thing</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>thing</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-147"></a>          <span class='hs-varid'>pprIfaceTvBndrs</span> <span class='hs-varid'>tyvars</span><span class='hs-keyglyph'>]</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="pp_condecls"></a><span class='hs-definition'>pp_condecls</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceConDecls</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-150"></a><span class='hs-definition'>pp_condecls</span> <span class='hs-keyword'>_</span>  <span class='hs-layout'>(</span><span class='hs-conid'>IfAbstractTyCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-151"></a><span class='hs-definition'>pp_condecls</span> <span class='hs-keyword'>_</span>  <span class='hs-conid'>IfOpenDataTyCon</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-152"></a><span class='hs-definition'>pp_condecls</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfNewTyCon</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceConDecl</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>c</span>
<a name="line-153"></a><span class='hs-definition'>pp_condecls</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfDataTyCon</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>" |"</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-154"></a>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceConDecl</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-155"></a>
<a name="line-156"></a><a name="mkIfaceEqPred"></a><span class='hs-definition'>mkIfaceEqPred</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfacePredType</span>
<a name="line-157"></a><span class='hs-comment'>-- IA0_NOTE: This is wrong, but only used for pretty-printing.</span>
<a name="line-158"></a><span class='hs-definition'>mkIfaceEqPred</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTc</span> <span class='hs-varid'>eqTyConName</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ty1</span><span class='hs-layout'>,</span> <span class='hs-varid'>ty2</span><span class='hs-keyglyph'>]</span>
<a name="line-159"></a>
<a name="line-160"></a><a name="pprIfaceConDecl"></a><span class='hs-definition'>pprIfaceConDecl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceConDecl</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-161"></a><span class='hs-definition'>pprIfaceConDecl</span> <span class='hs-varid'>tc</span>
<a name="line-162"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>IfCon</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifConOcc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>name</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConInfix</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>is_infix</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConWrapper</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>has_wrap</span><span class='hs-layout'>,</span>
<a name="line-163"></a>                 <span class='hs-varid'>ifConUnivTvs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>univ_tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConExTvs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ex_tvs</span><span class='hs-layout'>,</span>
<a name="line-164"></a>                 <span class='hs-varid'>ifConEqSpec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>eq_spec</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConCtxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConArgTys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arg_tys</span><span class='hs-layout'>,</span>
<a name="line-165"></a>                 <span class='hs-varid'>ifConStricts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>strs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifConFields</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fields</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-166"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>main_payload</span><span class='hs-layout'>,</span>
<a name="line-167"></a>         <span class='hs-keyword'>if</span> <span class='hs-varid'>is_infix</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Infix"</span><span class='hs-layout'>)</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>empty</span><span class='hs-layout'>,</span>
<a name="line-168"></a>         <span class='hs-keyword'>if</span> <span class='hs-varid'>has_wrap</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"HasWrapper"</span><span class='hs-layout'>)</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>empty</span><span class='hs-layout'>,</span>
<a name="line-169"></a>         <span class='hs-varid'>ppUnless</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>strs</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-170"></a>            <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Stricts:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr_bang</span> <span class='hs-varid'>strs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-171"></a>         <span class='hs-varid'>ppUnless</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>fields</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-172"></a>            <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Fields:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>fields</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-173"></a>  <span class='hs-keyword'>where</span>
<a name="line-174"></a>    <span class='hs-varid'>ppr_bang</span> <span class='hs-conid'>HsNoBang</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'_'</span>        <span class='hs-comment'>-- Want to see these</span>
<a name="line-175"></a>    <span class='hs-varid'>ppr_bang</span> <span class='hs-varid'>bang</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bang</span>
<a name="line-176"></a>
<a name="line-177"></a>    <span class='hs-varid'>main_payload</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-178"></a>                   <span class='hs-varid'>pprIfaceForAllPart</span> <span class='hs-layout'>(</span><span class='hs-varid'>univ_tvs</span> <span class='hs-varop'>++</span> <span class='hs-varid'>ex_tvs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>eq_ctxt</span> <span class='hs-varop'>++</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>)</span> <span class='hs-varid'>pp_tau</span>
<a name="line-179"></a>
<a name="line-180"></a>    <span class='hs-varid'>eq_ctxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>mkIfaceEqPred</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-layout'>(</span><span class='hs-varid'>occNameFS</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-181"></a>              <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>tv</span><span class='hs-layout'>,</span><span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>eq_spec</span><span class='hs-keyglyph'>]</span>
<a name="line-182"></a>
<a name="line-183"></a>        <span class='hs-comment'>-- A bit gruesome this, but we can't form the full con_tau, and ppr it,</span>
<a name="line-184"></a>        <span class='hs-comment'>-- because we don't have a Name for the tycon, only an OccName</span>
<a name="line-185"></a>    <span class='hs-varid'>pp_tau</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>map</span> <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-varid'>arg_tys</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_res_ty</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>of</span>
<a name="line-186"></a>                <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-varid'>ts</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span> <span class='hs-conop'>:</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>arrow</span> <span class='hs-varop'>&lt;+&gt;</span><span class='hs-layout'>)</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-187"></a>                <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"pp_con_taus"</span>
<a name="line-188"></a>
<a name="line-189"></a>    <span class='hs-varid'>pp_res_ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>fsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>tv</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>univ_tvs</span><span class='hs-keyglyph'>]</span>
<a name="line-190"></a>
<a name="line-191"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceRule</span> <span class='hs-keyword'>where</span>
<a name="line-192"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceRule</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifRuleName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>name</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifActivation</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>act</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleBndrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span>
<a name="line-193"></a>                   <span class='hs-varid'>ifRuleHead</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fn</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleArgs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>args</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleRhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rhs</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-194"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>doubleQuotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ftext</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>act</span><span class='hs-layout'>,</span>
<a name="line-195"></a>                 <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"forall"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceBndrs</span> <span class='hs-varid'>bndrs</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-196"></a>           <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>fn</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pprParendIfaceExpr</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-197"></a>                        <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"="</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>rhs</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-198"></a>      <span class='hs-keyglyph'>]</span>
<a name="line-199"></a>
<a name="line-200"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceInst</span> <span class='hs-keyword'>where</span>
<a name="line-201"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceInst</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifDFun</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dfun_id</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifOFlag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flag</span><span class='hs-layout'>,</span>
<a name="line-202"></a>                  <span class='hs-varid'>ifInstCls</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cls</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifInstTys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mb_tcs</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-203"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"instance"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>flag</span>
<a name="line-204"></a>                <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>cls</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr_rough</span> <span class='hs-varid'>mb_tcs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-205"></a>         <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>dfun_id</span><span class='hs-layout'>)</span>
<a name="line-206"></a>
<a name="line-207"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceFamInst</span> <span class='hs-keyword'>where</span>
<a name="line-208"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFamInst</span> <span class='hs-layout'>{</span><span class='hs-varid'>ifFamInstFam</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fam</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifFamInstTys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mb_tcs</span><span class='hs-layout'>,</span>
<a name="line-209"></a>                     <span class='hs-varid'>ifFamInstTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon_id</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-210"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"family instance"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-211"></a>            <span class='hs-varid'>ppr</span> <span class='hs-varid'>fam</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr_rough</span> <span class='hs-varid'>mb_tcs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-212"></a>         <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tycon_id</span><span class='hs-layout'>)</span>
<a name="line-213"></a>
<a name="line-214"></a><a name="ppr_rough"></a><span class='hs-definition'>ppr_rough</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-215"></a><span class='hs-definition'>ppr_rough</span> <span class='hs-conid'>Nothing</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dot</span>
<a name="line-216"></a><span class='hs-definition'>ppr_rough</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span>
</pre>\end{code}


----------------------------- Printing IfaceExpr ------------------------------------

\begin{code}
<pre><a name="line-1"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-keyword'>where</span>
<a name="line-2"></a>    <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>e</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="pprParendIfaceExpr"></a><span class='hs-definition'>pprParendIfaceExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-5"></a><span class='hs-definition'>pprParendIfaceExpr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>parens</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="pprIfaceExpr"></a><span class='hs-comment'>-- | Pretty Print an IfaceExpre</span>
<a name="line-8"></a><span class='hs-comment'>--</span>
<a name="line-9"></a><span class='hs-comment'>-- The first argument should be a function that adds parens in context that need</span>
<a name="line-10"></a><span class='hs-comment'>-- an atomic value (e.g. function args)</span>
<a name="line-11"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-12"></a>
<a name="line-13"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLcl</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>v</span>
<a name="line-14"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceExt</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>v</span>
<a name="line-15"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLit</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span>
<a name="line-16"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFCall</span> <span class='hs-varid'>cc</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>cc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-17"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-varid'>ty</span>
<a name="line-18"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"@~"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-varid'>co</span>
<a name="line-19"></a>
<a name="line-20"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-varid'>app</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceApp</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceApp</span> <span class='hs-varid'>app</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>
<a name="line-21"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTuple</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tupleParens</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>interpp'SP</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span>
<a name="line-22"></a>
<a name="line-23"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceLam</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-24"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>char</span> <span class='hs-chr'>'\\'</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bndrs</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>arrow</span><span class='hs-layout'>,</span>
<a name="line-25"></a>                  <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-26"></a>  <span class='hs-keyword'>where</span>
<a name="line-27"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span><span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>collect</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>i</span>
<a name="line-28"></a>    <span class='hs-varid'>collect</span> <span class='hs-varid'>bs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLam</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>collect</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>bs</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-29"></a>    <span class='hs-varid'>collect</span> <span class='hs-varid'>bs</span> <span class='hs-varid'>e</span>              <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>reverse</span> <span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCase</span> <span class='hs-varid'>scrut</span> <span class='hs-varid'>bndr</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>con</span><span class='hs-layout'>,</span> <span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-32"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"case"</span><span class='hs-layout'>)</span> 
<a name="line-33"></a>			<span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>scrut</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"of"</span><span class='hs-layout'>)</span> 
<a name="line-34"></a>			<span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bndr</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'{'</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_con_bs</span> <span class='hs-varid'>con</span> <span class='hs-varid'>bs</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>arrow</span><span class='hs-layout'>,</span>
<a name="line-35"></a>  		  <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>rhs</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'}'</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-36"></a>
<a name="line-37"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCase</span> <span class='hs-varid'>scrut</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span>
<a name="line-38"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"case"</span><span class='hs-layout'>)</span> 
<a name="line-39"></a>		 	<span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>scrut</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"of"</span><span class='hs-layout'>)</span> 
<a name="line-40"></a>			<span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bndr</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'{'</span><span class='hs-layout'>,</span>
<a name="line-41"></a>  		  <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr_alt</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'}'</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-42"></a>
<a name="line-43"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-keyword'>_</span>       <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCast</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-44"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprParendIfaceExpr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>,</span>
<a name="line-45"></a>         <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"`cast`"</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-46"></a>         <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-47"></a>
<a name="line-48"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLet</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNonRec</span> <span class='hs-varid'>b</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-49"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"let {"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-50"></a>                  <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_bind</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-51"></a>                  <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"} in"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-52"></a>                  <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-53"></a>
<a name="line-54"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLet</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceRec</span> <span class='hs-varid'>pairs</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-55"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"letrec {"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-56"></a>                  <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr_bind</span> <span class='hs-varid'>pairs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-57"></a>                  <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"} in"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-58"></a>                  <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-59"></a>
<a name="line-60"></a><span class='hs-definition'>pprIfaceExpr</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTick</span> <span class='hs-varid'>tickish</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-61"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>add_par</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceTickish</span> <span class='hs-varid'>tickish</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-62"></a>
<a name="line-63"></a><a name="ppr_alt"></a><span class='hs-definition'>ppr_alt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceConAlt</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfLclName</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-64"></a><span class='hs-definition'>ppr_alt</span> <span class='hs-layout'>(</span><span class='hs-varid'>con</span><span class='hs-layout'>,</span> <span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_con_bs</span> <span class='hs-varid'>con</span> <span class='hs-varid'>bs</span><span class='hs-layout'>,</span>
<a name="line-65"></a>                         <span class='hs-varid'>arrow</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>rhs</span><span class='hs-keyglyph'>]</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="ppr_con_bs"></a><span class='hs-definition'>ppr_con_bs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceConAlt</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfLclName</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-68"></a><span class='hs-definition'>ppr_con_bs</span> <span class='hs-varid'>con</span> <span class='hs-varid'>bs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>con</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bs</span><span class='hs-layout'>)</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="ppr_bind"></a><span class='hs-definition'>ppr_bind</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLetBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceExpr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-71"></a><span class='hs-definition'>ppr_bind</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLetBndr</span> <span class='hs-varid'>b</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>info</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span>
<a name="line-72"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>b</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-73"></a>         <span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceExpr</span> <span class='hs-varid'>noParens</span> <span class='hs-varid'>rhs</span><span class='hs-keyglyph'>]</span>
<a name="line-74"></a>
<a name="line-75"></a><a name="pprIfaceTickish"></a><span class='hs-comment'>------------------</span>
<a name="line-76"></a><span class='hs-definition'>pprIfaceTickish</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTickish</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-77"></a><span class='hs-definition'>pprIfaceTickish</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceHpcTick</span> <span class='hs-varid'>m</span> <span class='hs-varid'>ix</span><span class='hs-layout'>)</span>
<a name="line-78"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"tick"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ix</span><span class='hs-layout'>)</span>
<a name="line-79"></a><span class='hs-definition'>pprIfaceTickish</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSCC</span> <span class='hs-varid'>cc</span> <span class='hs-varid'>tick</span> <span class='hs-varid'>scope</span><span class='hs-layout'>)</span>
<a name="line-80"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCostCentreCore</span> <span class='hs-varid'>cc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tick</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>scope</span><span class='hs-layout'>)</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="pprIfaceApp"></a><span class='hs-comment'>------------------</span>
<a name="line-83"></a><span class='hs-definition'>pprIfaceApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>SDoc</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-84"></a><span class='hs-definition'>pprIfaceApp</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceApp</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceApp</span> <span class='hs-varid'>fun</span> <span class='hs-varop'>$</span>
<a name="line-85"></a>                                          <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprParendIfaceExpr</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>args</span>
<a name="line-86"></a><span class='hs-definition'>pprIfaceApp</span> <span class='hs-varid'>fun</span>                <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprParendIfaceExpr</span> <span class='hs-varid'>fun</span> <span class='hs-conop'>:</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-87"></a>
<a name="line-88"></a><span class='hs-comment'>------------------</span>
<a name="line-89"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceConAlt</span> <span class='hs-keyword'>where</span>
<a name="line-90"></a>    <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfaceDefault</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"DEFAULT"</span>
<a name="line-91"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitAlt</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span>
<a name="line-92"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceDataAlt</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>d</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-comment'>------------------</span>
<a name="line-95"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceIdDetails</span> <span class='hs-keyword'>where</span>
<a name="line-96"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfVanillaId</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-97"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfRecSelId</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"RecSel"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span>
<a name="line-98"></a>                          <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"&lt;naughty&gt;"</span><span class='hs-layout'>)</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>empty</span>
<a name="line-99"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfDFunId</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"DFunId"</span><span class='hs-layout'>)</span>
<a name="line-100"></a>
<a name="line-101"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceIdInfo</span> <span class='hs-keyword'>where</span>
<a name="line-102"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>NoInfo</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-103"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasInfo</span> <span class='hs-varid'>is</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"{-"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>is</span>
<a name="line-104"></a>                     <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"-}"</span><span class='hs-layout'>)</span>
<a name="line-105"></a>
<a name="line-106"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceInfoItem</span> <span class='hs-keyword'>where</span>
<a name="line-107"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnfold</span> <span class='hs-varid'>lb</span> <span class='hs-varid'>unf</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Unfolding"</span><span class='hs-layout'>)</span>
<a name="line-108"></a>                           <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppWhen</span> <span class='hs-varid'>lb</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"(loop-breaker)"</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-109"></a>                           <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>colon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>unf</span>
<a name="line-110"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsInline</span> <span class='hs-varid'>prag</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Inline:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>prag</span>
<a name="line-111"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsArity</span> <span class='hs-varid'>arity</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Arity:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>int</span> <span class='hs-varid'>arity</span>
<a name="line-112"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsStrictness</span> <span class='hs-varid'>str</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Strictness:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceStrictSig</span> <span class='hs-varid'>str</span>
<a name="line-113"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>HsNoCafRefs</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"HasNoCafRefs"</span><span class='hs-layout'>)</span>
<a name="line-114"></a>
<a name="line-115"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceUnfolding</span> <span class='hs-keyword'>where</span>
<a name="line-116"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfCompulsory</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"&lt;compulsory&gt;"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-117"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfCoreUnfold</span> <span class='hs-varid'>s</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"&lt;stable&gt;"</span><span class='hs-layout'>)</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<a name="line-118"></a>                              <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-119"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfInlineRule</span> <span class='hs-varid'>a</span> <span class='hs-varid'>uok</span> <span class='hs-varid'>bok</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"InlineRule"</span><span class='hs-layout'>)</span>
<a name="line-120"></a>                                            <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>uok</span><span class='hs-layout'>,</span><span class='hs-varid'>bok</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-121"></a>                                        <span class='hs-varid'>pprParendIfaceExpr</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>]</span>
<a name="line-122"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLclWrapper</span> <span class='hs-varid'>a</span> <span class='hs-varid'>wkr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Worker(lcl):"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>wkr</span>
<a name="line-123"></a>                             <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"arity"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>int</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-124"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfExtWrapper</span> <span class='hs-varid'>a</span> <span class='hs-varid'>wkr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"Worker(ext0:"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>wkr</span>
<a name="line-125"></a>                             <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"arity"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>int</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-126"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfDFunUnfold</span> <span class='hs-varid'>ns</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"DFun:"</span><span class='hs-layout'>)</span>
<a name="line-127"></a>                             <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ns</span><span class='hs-layout'>)</span>
<a name="line-128"></a>
<a name="line-129"></a><span class='hs-comment'>-- -----------------------------------------------------------------------------</span>
<a name="line-130"></a><span class='hs-comment'>-- | Finding the Names in IfaceSyn</span>
<a name="line-131"></a>
<a name="line-132"></a><span class='hs-comment'>-- This is used for dependency analysis in MkIface, so that we</span>
<a name="line-133"></a><span class='hs-comment'>-- fingerprint a declaration before the things that depend on it.  It</span>
<a name="line-134"></a><span class='hs-comment'>-- is specific to interface-file fingerprinting in the sense that we</span>
<a name="line-135"></a><span class='hs-comment'>-- don't collect *all* Names: for example, the DFun of an instance is</span>
<a name="line-136"></a><span class='hs-comment'>-- recorded textually rather than by its fingerprint when</span>
<a name="line-137"></a><span class='hs-comment'>-- fingerprinting the instance, so DFuns are not dependencies.</span>
<a name="line-138"></a>
<a name="line-139"></a><a name="freeNamesIfDecl"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceDecl</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-140"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceId</span> <span class='hs-sel'>_s</span> <span class='hs-varid'>t</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-141"></a>  <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>t</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-142"></a>  <span class='hs-varid'>freeNamesIfIdInfo</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-143"></a>  <span class='hs-varid'>freeNamesIfIdDetails</span> <span class='hs-varid'>d</span>
<a name="line-144"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-conid'>IfaceForeign</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span>
<a name="line-145"></a>  <span class='hs-varid'>emptyNameSet</span>
<a name="line-146"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-varid'>d</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>IfaceData</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span>
<a name="line-147"></a>  <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifTyVars</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-148"></a>  <span class='hs-varid'>freeNamesIfTcFam</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifFamInst</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-149"></a>  <span class='hs-varid'>freeNamesIfContext</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifCtxt</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-150"></a>  <span class='hs-varid'>freeNamesIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifCons</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-151"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-varid'>d</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>IfaceSyn</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span>
<a name="line-152"></a>  <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifTyVars</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-153"></a>  <span class='hs-varid'>freeNamesIfSynRhs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifSynRhs</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-154"></a>  <span class='hs-varid'>freeNamesIfTcFam</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifFamInst</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-155"></a>  <span class='hs-varid'>freeNamesIfKind</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifSynKind</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- IA0_NOTE: because of promotion, we</span>
<a name="line-156"></a>                                <span class='hs-comment'>-- return names in the kind signature</span>
<a name="line-157"></a><span class='hs-definition'>freeNamesIfDecl</span> <span class='hs-varid'>d</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>IfaceClass</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span>
<a name="line-158"></a>  <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifTyVars</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-159"></a>  <span class='hs-varid'>freeNamesIfContext</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifCtxt</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-160"></a>  <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfAT</span>     <span class='hs-layout'>(</span><span class='hs-varid'>ifATs</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-161"></a>  <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfClsSig</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifSigs</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-162"></a>
<a name="line-163"></a><a name="freeNamesIfIdDetails"></a><span class='hs-definition'>freeNamesIfIdDetails</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdDetails</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-164"></a><span class='hs-definition'>freeNamesIfIdDetails</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfRecSelId</span> <span class='hs-varid'>tc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfTc</span> <span class='hs-varid'>tc</span>
<a name="line-165"></a><span class='hs-definition'>freeNamesIfIdDetails</span> <span class='hs-keyword'>_</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-166"></a>
<a name="line-167"></a><a name="freeNamesIfSynRhs"></a><span class='hs-comment'>-- All other changes are handled via the version info on the tycon</span>
<a name="line-168"></a><span class='hs-definition'>freeNamesIfSynRhs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-169"></a><span class='hs-definition'>freeNamesIfSynRhs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-170"></a><span class='hs-definition'>freeNamesIfSynRhs</span> <span class='hs-conid'>Nothing</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-171"></a>
<a name="line-172"></a><a name="freeNamesIfTcFam"></a><span class='hs-definition'>freeNamesIfTcFam</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-173"></a><span class='hs-definition'>freeNamesIfTcFam</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>tc</span><span class='hs-layout'>,</span><span class='hs-varid'>tys</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-174"></a>  <span class='hs-varid'>freeNamesIfTc</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>tys</span>
<a name="line-175"></a><span class='hs-definition'>freeNamesIfTcFam</span> <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>=</span>
<a name="line-176"></a>  <span class='hs-varid'>emptyNameSet</span>
<a name="line-177"></a>
<a name="line-178"></a><a name="freeNamesIfContext"></a><span class='hs-definition'>freeNamesIfContext</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceContext</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-179"></a><span class='hs-definition'>freeNamesIfContext</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span>
<a name="line-180"></a>
<a name="line-181"></a><a name="freeNamesIfAT"></a><span class='hs-definition'>freeNamesIfAT</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-182"></a><span class='hs-definition'>freeNamesIfAT</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAT</span> <span class='hs-varid'>decl</span> <span class='hs-varid'>defs</span><span class='hs-layout'>)</span>
<a name="line-183"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfDecl</span> <span class='hs-varid'>decl</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-184"></a>    <span class='hs-varid'>fnList</span> <span class='hs-varid'>fn_at_def</span> <span class='hs-varid'>defs</span>
<a name="line-185"></a>  <span class='hs-keyword'>where</span>
<a name="line-186"></a>    <span class='hs-varid'>fn_at_def</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceATD</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>pat_tys</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-187"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-varid'>tvs</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-188"></a>        <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>pat_tys</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-189"></a>        <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-190"></a>
<a name="line-191"></a><a name="freeNamesIfClsSig"></a><span class='hs-definition'>freeNamesIfClsSig</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceClassOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-192"></a><span class='hs-definition'>freeNamesIfClsSig</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceClassOp</span> <span class='hs-sel'>_n</span> <span class='hs-sel'>_dm</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-193"></a>
<a name="line-194"></a><a name="freeNamesIfConDecls"></a><span class='hs-definition'>freeNamesIfConDecls</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceConDecls</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-195"></a><span class='hs-definition'>freeNamesIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfDataTyCon</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfConDecl</span> <span class='hs-varid'>c</span>
<a name="line-196"></a><span class='hs-definition'>freeNamesIfConDecls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfNewTyCon</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfConDecl</span> <span class='hs-varid'>c</span>
<a name="line-197"></a><span class='hs-definition'>freeNamesIfConDecls</span> <span class='hs-keyword'>_</span>               <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-198"></a>
<a name="line-199"></a><a name="freeNamesIfConDecl"></a><span class='hs-definition'>freeNamesIfConDecl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceConDecl</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-200"></a><span class='hs-definition'>freeNamesIfConDecl</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span>
<a name="line-201"></a>  <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifConUnivTvs</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-202"></a>  <span class='hs-varid'>freeNamesIfTvBndrs</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifConExTvs</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-203"></a>  <span class='hs-varid'>freeNamesIfContext</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifConCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-204"></a>  <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifConArgTys</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-205"></a>  <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>snd</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifConEqSpec</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- equality constraints</span>
<a name="line-206"></a>
<a name="line-207"></a><a name="freeNamesIfKind"></a><span class='hs-definition'>freeNamesIfKind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-208"></a><span class='hs-definition'>freeNamesIfKind</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span>
<a name="line-209"></a>
<a name="line-210"></a><a name="freeNamesIfType"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-211"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-212"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>s</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>t</span>
<a name="line-213"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-214"></a>   <span class='hs-varid'>freeNamesIfTc</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ts</span>
<a name="line-215"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>tv</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span>
<a name="line-216"></a>   <span class='hs-varid'>freeNamesIfTvBndr</span> <span class='hs-varid'>tv</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>t</span>
<a name="line-217"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>s</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>t</span>
<a name="line-218"></a><span class='hs-definition'>freeNamesIfType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> 
<a name="line-219"></a>   <span class='hs-varid'>freeNamesIfCo</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ts</span>
<a name="line-220"></a>
<a name="line-221"></a><a name="freeNamesIfTvBndrs"></a><span class='hs-definition'>freeNamesIfTvBndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTvBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-222"></a><span class='hs-definition'>freeNamesIfTvBndrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfTvBndr</span>
<a name="line-223"></a>
<a name="line-224"></a><a name="freeNamesIfBndr"></a><span class='hs-definition'>freeNamesIfBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-225"></a><span class='hs-definition'>freeNamesIfBndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfIdBndr</span> <span class='hs-varid'>b</span>
<a name="line-226"></a><span class='hs-definition'>freeNamesIfBndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfTvBndr</span> <span class='hs-varid'>b</span>
<a name="line-227"></a>
<a name="line-228"></a><a name="freeNamesIfLetBndr"></a><span class='hs-definition'>freeNamesIfLetBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceLetBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-229"></a><span class='hs-comment'>-- Remember IfaceLetBndr is used only for *nested* bindings</span>
<a name="line-230"></a><span class='hs-comment'>-- The IdInfo can contain an unfolding (in the case of</span>
<a name="line-231"></a><span class='hs-comment'>-- local INLINE pragmas), so look there too</span>
<a name="line-232"></a><span class='hs-definition'>freeNamesIfLetBndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLetBndr</span> <span class='hs-sel'>_name</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-233"></a>                                             <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfIdInfo</span> <span class='hs-varid'>info</span>
<a name="line-234"></a>
<a name="line-235"></a><a name="freeNamesIfTvBndr"></a><span class='hs-definition'>freeNamesIfTvBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-236"></a><span class='hs-definition'>freeNamesIfTvBndr</span> <span class='hs-layout'>(</span><span class='hs-sel'>_fs</span><span class='hs-layout'>,</span><span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfKind</span> <span class='hs-varid'>k</span>
<a name="line-237"></a>    <span class='hs-comment'>-- kinds can have Names inside, because of promotion</span>
<a name="line-238"></a>
<a name="line-239"></a><a name="freeNamesIfIdBndr"></a><span class='hs-definition'>freeNamesIfIdBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-240"></a><span class='hs-definition'>freeNamesIfIdBndr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfTvBndr</span>
<a name="line-241"></a>
<a name="line-242"></a><a name="freeNamesIfIdInfo"></a><span class='hs-definition'>freeNamesIfIdInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-243"></a><span class='hs-definition'>freeNamesIfIdInfo</span> <span class='hs-conid'>NoInfo</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-244"></a><span class='hs-definition'>freeNamesIfIdInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasInfo</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesItem</span> <span class='hs-varid'>i</span>
<a name="line-245"></a>
<a name="line-246"></a><a name="freeNamesItem"></a><span class='hs-definition'>freeNamesItem</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceInfoItem</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-247"></a><span class='hs-definition'>freeNamesItem</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfUnfold</span> <span class='hs-varid'>u</span>
<a name="line-248"></a><span class='hs-definition'>freeNamesItem</span> <span class='hs-keyword'>_</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-249"></a>
<a name="line-250"></a><a name="freeNamesIfUnfold"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceUnfolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-251"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfCoreUnfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>e</span>
<a name="line-252"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfCompulsory</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>e</span>
<a name="line-253"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfInlineRule</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>e</span>
<a name="line-254"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfExtWrapper</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>v</span>
<a name="line-255"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLclWrapper</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-256"></a><span class='hs-definition'>freeNamesIfUnfold</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfDFunUnfold</span> <span class='hs-varid'>vs</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>vs</span>
<a name="line-257"></a>
<a name="line-258"></a><a name="freeNamesIfExpr"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-259"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceExt</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>v</span>
<a name="line-260"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFCall</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-261"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>ty</span>
<a name="line-262"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>co</span>
<a name="line-263"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTuple</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-keyword'>as</span>
<a name="line-264"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLam</span> <span class='hs-varid'>b</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfBndr</span> <span class='hs-varid'>b</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>body</span>
<a name="line-265"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceApp</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>f</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>a</span>
<a name="line-266"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCast</span> <span class='hs-varid'>e</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfType</span> <span class='hs-varid'>co</span>
<a name="line-267"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTick</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>e</span>
<a name="line-268"></a>
<a name="line-269"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCase</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span>
<a name="line-270"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>s</span> 
<a name="line-271"></a>    <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>fn_alt</span> <span class='hs-varid'>alts</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>fn_cons</span> <span class='hs-varid'>alts</span>
<a name="line-272"></a>  <span class='hs-keyword'>where</span>
<a name="line-273"></a>    <span class='hs-varid'>fn_alt</span> <span class='hs-layout'>(</span><span class='hs-sel'>_con</span><span class='hs-layout'>,</span><span class='hs-sel'>_bs</span><span class='hs-layout'>,</span><span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>r</span>
<a name="line-274"></a>
<a name="line-275"></a>    <span class='hs-comment'>-- Depend on the data constructors.  Just one will do!</span>
<a name="line-276"></a>    <span class='hs-comment'>-- Note [Tracking data constructors]</span>
<a name="line-277"></a>    <span class='hs-varid'>fn_cons</span> <span class='hs-conid'>[]</span>                            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-278"></a>    <span class='hs-varid'>fn_cons</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceDefault</span>    <span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fn_cons</span> <span class='hs-varid'>xs</span>
<a name="line-279"></a>    <span class='hs-varid'>fn_cons</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceDataAlt</span> <span class='hs-varid'>con</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>con</span>
<a name="line-280"></a>    <span class='hs-varid'>fn_cons</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span>                      <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-281"></a>
<a name="line-282"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLet</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNonRec</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-283"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfLetBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>rhs</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>body</span>
<a name="line-284"></a>
<a name="line-285"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLet</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceRec</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-286"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fnList</span> <span class='hs-varid'>fn_pair</span> <span class='hs-keyword'>as</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>x</span>
<a name="line-287"></a>  <span class='hs-keyword'>where</span>
<a name="line-288"></a>    <span class='hs-varid'>fn_pair</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndr</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freeNamesIfLetBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-varop'>&amp;&amp;&amp;</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>rhs</span>
<a name="line-289"></a>
<a name="line-290"></a><span class='hs-definition'>freeNamesIfExpr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-291"></a>
<a name="line-292"></a><a name="freeNamesIfTc"></a><span class='hs-definition'>freeNamesIfTc</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-293"></a><span class='hs-definition'>freeNamesIfTc</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTc</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>tc</span>
<a name="line-294"></a><span class='hs-comment'>-- ToDo: shouldn't we include IfaceIntTc &amp; co.?</span>
<a name="line-295"></a><span class='hs-definition'>freeNamesIfTc</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-296"></a>
<a name="line-297"></a><a name="freeNamesIfCo"></a><span class='hs-definition'>freeNamesIfCo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceCoCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-298"></a><span class='hs-definition'>freeNamesIfCo</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoAx</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>tc</span>
<a name="line-299"></a><span class='hs-comment'>-- ToDo: include IfaceIPCoAx? Probably not necessary.</span>
<a name="line-300"></a><span class='hs-definition'>freeNamesIfCo</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyNameSet</span>
<a name="line-301"></a>
<a name="line-302"></a><a name="freeNamesIfRule"></a><span class='hs-definition'>freeNamesIfRule</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceRule</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-303"></a><span class='hs-definition'>freeNamesIfRule</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceRule</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifRuleBndrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleHead</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span>
<a name="line-304"></a>                           <span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleArgs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>es</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifRuleRhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rhs</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-305"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unitNameSet</span> <span class='hs-varid'>f</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-306"></a>    <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfBndr</span> <span class='hs-varid'>bs</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-307"></a>    <span class='hs-varid'>fnList</span> <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>es</span> <span class='hs-varop'>&amp;&amp;&amp;</span>
<a name="line-308"></a>    <span class='hs-varid'>freeNamesIfExpr</span> <span class='hs-varid'>rhs</span>
<a name="line-309"></a>
<a name="line-310"></a><a name="&&&"></a><span class='hs-comment'>-- helpers</span>
<a name="line-311"></a><span class='hs-layout'>(</span><span class='hs-varop'>&amp;&amp;&amp;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NameSet</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-312"></a><span class='hs-layout'>(</span><span class='hs-varop'>&amp;&amp;&amp;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unionNameSets</span>
<a name="line-313"></a>
<a name="line-314"></a><a name="fnList"></a><span class='hs-definition'>fnList</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NameSet</span>
<a name="line-315"></a><span class='hs-definition'>fnList</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-layout'>(</span><span class='hs-varop'>&amp;&amp;&amp;</span><span class='hs-layout'>)</span> <span class='hs-varid'>emptyNameSet</span> <span class='hs-varop'>.</span> <span class='hs-varid'>map</span> <span class='hs-varid'>f</span>
</pre>\end{code}

Note [Tracking data constructors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a case expression
   case e of { C a -> ...; ... }
You might think that we don't need to include the datacon C
in the free names, because its type will probably show up in
the free names of 'e'.  But in rare circumstances this may
not happen.   Here's the one that bit me:

   module DynFlags where
     import {-# SOURCE #-} Packages( PackageState )
     data DynFlags = DF ... PackageState ...

   module Packages where
     import DynFlags
     data PackageState = PS ...
     lookupModule (df :: DynFlags)
        = case df of
              DF ...p... -> case p of
                               PS ... -> ...

Now, lookupModule depends on DynFlags, but the transitive dependency
on the *locally-defined* type PackageState is not visible. We need
to take account of the use of the data constructor PS in the pattern match.

</body>
</html>
